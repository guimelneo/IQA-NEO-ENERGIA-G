<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Atendimento - Neoenergia</title>
    <link rel="icon" type="image/png" href="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/Neoenergia_logo.svg/1200px-Neoenergia_logo.svg.png">
    <style>
        /* CSS Custom Properties (Variables) */
        :root {
            /* Default (Dark Mode) Colors */
            --main-bg-color: #000000; /* Fundo principal da p√°gina */
            --container-bg-color: #000000; /* Fundo dos blocos principais (formul√°rio, se√ß√µes de info) */
            --main-text-color: #FFFFFF; /* Cor do texto geral da p√°gina */
            --label-color: #EEEEEE; /* Cor das labels (geral, n√£o as verdes espec√≠ficas) */
            --input-bg-color: #444444; /* Fundo dos campos de entrada */
            --input-border-color: #555555; /* Borda dos campos de entrada */
            --input-text-color: #FFFFFF; /* Cor do texto dentro dos campos de entrada */
            --copy-button-bg: #4CAF50; /* Fundo do bot√£o Copiar/Alternar */
            --copy-button-text: #FFFFFF; /* Texto do bot√£o Copiar/Alternar */
            --clear-button-bg: #e0e0e0; /* Fundo do bot√£o Limpar */
            --clear-button-text: #000000; /* Texto do bot√£o Limpar */
            --output-bg-color: #222222; /* Fundo da √°rea de sa√≠da e conte√∫do de informa√ß√µes */
            --output-text-color: #FFFFFF; /* Texto da √°rea de sa√≠da e conte√∫do de informa√ß√µes */
            --output-border-color: #555555; /* Borda da √°rea de sa√≠da e conte√∫do de informa√ß√µes */
            --history-item-bg-color: #222222; /* Fundo dos itens do hist√≥rico */
            --history-item-border-color: #333333; /* Borda dos itens do hist√≥rico */
            --history-item-text-color: #FFFFFF; /* Texto dos itens do hist√≥rico */
            --modal-bg-color: #222222; /* Fundo dos modais */
            --modal-text-color: #FFFFFF; /* Texto dos modais */
            --modal-border-color: #555555; /* Borda dos modais */
            --search-input-bg-color: #444444; /* Fundo dos campos de pesquisa */
            --search-input-text-color: #FFFFFF; /* Texto dos campos de pesquisa */
            --search-input-border-color: #555555; /* Borda dos campos de pesquisa */
            --highlight-green: #4CAF50; /* Cor verde para destaque (ex: logo, labels espec√≠ficas) */
            --highlight-light-green: #6dff73; /* Cor verde claro para subt√≠tulos de destaque */
            --field-bg-alpha: 0.7; /* Opacidade padr√£o para campos quando imagem de fundo presente */
        }

        /* Light Mode Overrides (if light-mode class is active) */
        /* APENAS as cores que DEVEM MUDAR no modo claro */
        body.light-mode {
            --main-bg-color: #f0f0f0; /* Fundo principal da p√°gina CLARO */
            --main-text-color: #333333; /* Cor do texto geral da p√°gina CLARO */
            --label-color: #555555; /* Cor das labels (geral, n√£o as verdes espec√≠ficas) CLARO */
            --clear-button-bg: #cccccc; /* Fundo do bot√£o Limpar CLARO */
            --clear-button-text: #333333; /* Texto do bot√£o Limpar CLARO */
            /* As demais vari√°veis (input, output, history, modal, search, container)
               manter√£o seus valores padr√£o (do tema escuro) para o formul√°rio permanecer escuro. */
        }

        /* Reset b√°sico para garantir que n√£o haja margens/padding padr√£o no html/body */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%; /* Garante que o body ocupe a altura total da viewport */
        }

        body {
            font-family: Arial, sans-serif;
            background-color: var(--main-bg-color); /* Usando vari√°vel CSS */
            color: var(--main-text-color); /* Usando vari√°vel CSS */
            display: flex;
            flex-direction: column; /* Para empilhar o formul√°rio e as se√ß√µes de consulta/hist√≥rico */
            justify-content: flex-start; /* Alinha no topo */
            align-items: center; /* Centraliza horizontalmente */
            min-height: 100vh;
            padding: 20px; /* Mant√©m o padding externo para os containers n√£o colarem nas bordas */
            box-sizing: border-box;
            position: relative; /* Adicionado para posicionar o bot√£o de tema */
            transition: background-color 0.3s ease, color 0.3s ease; /* Adicionado para transi√ß√£o suave */
            
            /* Background image properties */
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
        }

        /* Regra para cont√™ineres/se√ß√µes principais serem TOTALMENTE transparentes quando h√° imagem de fundo */
        body.has-background-image .container,
        body.has-background-image .info-section,
        body.has-background-image #outputContainer {
            background-color: transparent !important; /* Torna o fundo do cont√™iner principal transparente */
            border: none !important;
            box-shadow: none !important;
        }

        /* Regra para campos interativos e √°reas de conte√∫do serem PRETO TRANSPARENTE quando h√° imagem de fundo */
        body.has-background-image input[type="text"],
        body.has-background-image input[type="tel"],
        body.has-background-image select,
        body.has-background-image textarea, /* Afeta #observacoes, #notepadContent, #outputContent, #personalPasswordsContent */
        body.has-background-image .search-input, /* Campos de pesquisa */
        body.has-background-image .history-item, /* Itens individuais do hist√≥rico */
        body.has-background-image .info-content { /* Divs de conte√∫do das se√ß√µes de informa√ß√£o (n√£o textareas) */
            background-color: rgba(0, 0, 0, var(--field-bg-alpha)) !important; /* Preto com opacidade controlada pelo slider */
            border: none !important; /* Remove borda */
            box-shadow: none !important; /* Remove sombra */
            color: var(--input-text-color) !important; /* Mant√©m a cor do texto (geralmente branco) */
        }

        /* Ajuste espec√≠fico para as op√ß√µes dentro dos selects quando h√° imagem de fundo */
        body.has-background-image select option {
            background-color: rgba(0, 0, 0, var(--field-bg-alpha)) !important;
            color: var(--input-text-color) !important;
        }

        /* Estilos base para cont√™ineres e se√ß√µes (usar√£o as vars do root, que s√£o escuras) */
        .container, .info-section {
            background-color: var(--container-bg-color);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 600px;
            box-sizing: border-box;
            margin-bottom: 20px;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }

        .logo {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.8em;
            font-weight: bold;
            color: var(--highlight-green);
            text-transform: uppercase;
        }

        .logo .creator-signature {
            font-size: 0.5em;
            color: var(--highlight-green);
            display: block;
            margin-top: 5px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--label-color);
            transition: color 0.3s ease;
        }

        /* Labels espec√≠ficas em verde */
        label[for="empresa"],
        label[for="nome"],
        label[for="ucCpf"],
        label[for="telefone"],
        label[for="motivo"],
        label[for="referencia"],
        label[for="observacoes"] {
            color: var(--highlight-green);
        }

        /* Estilos base para inputs, selects e textareas (usar√£o as vars do root, que s√£o escuras) */
        input[type="text"],
        input[type="tel"],
        select,
        textarea {
            width: calc(100% - 22px);
            padding: 10px;
            border: 1px solid var(--input-border-color);
            border-radius: 4px;
            background-color: var(--input-bg-color);
            color: var(--input-text-color);
            font-size: 1em;
            box-sizing: border-box;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        select option {
            background-color: var(--input-bg-color);
            color: var(--input-text-color);
        }

        select option:checked {
            background-color: var(--input-border-color);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .copy-button, .toggle-button {
            background-color: var(--copy-button-bg);
            color: var(--copy-button-text);
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.1em;
            width: 100%;
            margin-top: 10px;
            text-transform: uppercase;
        }

        .copy-button:hover, .toggle-button:hover {
            filter: brightness(0.9);
        }
        
        .clear-form-button, .clear-button {
            background-color: var(--clear-button-bg);
            color: var(--clear-button-text);
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            text-transform: uppercase;
            margin-top: 10px;
            transition: background-color 0.2s ease, color 0.2s ease;
        }

        .clear-form-button:hover, .clear-button:hover {
            filter: brightness(0.9);
        }

        .clear-form-button {
            width: auto;
            display: block;
            margin: 10px auto;
        }

        .search-input {
            width: calc(100% - 22px);
            padding: 8px;
            margin-bottom: 15px;
            border: 1px solid var(--search-input-border-color);
            border-radius: 4px;
            background-color: var(--search-input-bg-color);
            color: var(--search-input-text-color);
            font-size: 0.9em;
            box-sizing: border-box;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        #outputContainer {
            margin-top: 20px;
            background-color: var(--output-bg-color);
            padding: 15px;
            border-radius: 4px;
            border: 1px solid var(--output-border-color);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        #outputContent {
            width: 100%;
            min-height: 150px;
            background-color: var(--output-bg-color);
            color: var(--output-text-color);
            border: none;
            resize: vertical;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.95em;
            box-sizing: border-box;
            padding: 5px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        #observacoes { 
            min-height: 60px;
        }
        /* Ajuste do tamanho do Bloco de Notas */
        #notepadContent { 
            min-height: 350px; /* Alterado de 300px para 350px */
        }
        /* Novo estilo para a se√ß√£o de Senhas Pessoais */
        #personalPasswordsContent {
            min-height: 150px; /* Altura n√£o muito grande */
        }


        .info-section h2 {
            text-align: center;
            margin-bottom: 20px;
            color: var(--highlight-green);
        }

        .info-content {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
            background-color: var(--output-bg-color);
            padding: 15px;
            border-radius: 4px;
            border: 1px solid var(--output-border-color);
            max-height: 500px;
            overflow-y: auto;
            display: none;
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
            color: var(--output-text-color);
        }

        .history-item {
            background-color: var(--history-item-bg-color);
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 10px;
            border: 1px solid var(--history-item-border-color);
            display: flex;
            flex-direction: column;
            gap: 5px;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .history-item-content {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
            color: var(--history-item-text-color);
        }

        .history-item-actions {
            display: flex;
            justify-content: flex-end; /* Alinha os bot√µes √† direita */
            margin-top: 5px;
            gap: 5px; /* Espa√ßo entre os bot√µes */
        }

        .history-item-copy-button, .history-item-delete-button {
            padding: 5px 10px; /* Reduz o padding */
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em; /* Reduz o tamanho da fonte */
            text-transform: none; /* Remove uppercase */
            width: auto; /* Permite que o width seja ajustado ao conte√∫do */
            flex-grow: 0; /* N√£o permite que os bot√µes se expandam */
        }

        .history-item-copy-button:hover {
            filter: brightness(0.9);
        }

        .history-item-delete-button {
            background-color: #f44336;
            color: white;
        }

        .history-item-delete-button:hover {
            filter: brightness(0.9);
        }

        .custom-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .custom-modal {
            background-color: var(--modal-bg-color);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.6);
            max-width: 400px;
            width: 90%;
            text-align: center;
            color: var(--modal-text-color);
            border: 1px solid var(--modal-border-color);
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        .custom-modal p {
            margin-bottom: 20px;
            font-size: 1.1em;
            word-wrap: break-word;
        }

        .custom-modal .modal-buttons button {
            background-color: var(--highlight-green);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            margin: 0 10px;
        }

        .custom-modal .modal-buttons button:hover {
            filter: brightness(0.9);
        }

        .custom-modal .modal-buttons button.cancel {
            background-color: #f44336;
        }

        .custom-modal .modal-buttons button.cancel:hover {
            filter: brightness(0.9);
        }

        #copyFeedback {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--highlight-green);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            z-index: 1000;
        }

        /* Removed #modeToggleButton styles as the button is removed */

        /* Estilos para espa√ßamento em Informa√ß√µes Adicionais e Personaliza√ß√£o de Cores */
        #additionalInfoContent h2, #colorCustomizationContent h2 {
            margin-top: 30px;
            margin-bottom: 15px;
            text-align: left;
            color: #4CAF50;
            font-size: 1.2em;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 5px;
        }

        #additionalInfoContent h3, #colorCustomizationContent h3 {
            margin-top: 20px;
            margin-bottom: 10px;
            text-align: left;
            color: var(--highlight-light-green);
            font-size: 1.1em;
        }

        #additionalInfoContent p, #colorCustomizationContent p {
            margin-bottom: 10px;
            line-height: 1.5;
        }

        #additionalInfoContent hr, #colorCustomizationContent hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border-color: #777;
            border-width: 1px;
            border-style: solid;
        }

        #additionalInfoContent ul, #additionalInfoContent ol, #colorCustomizationContent ul, #colorCustomizationContent ol {
            margin-top: 5px;
            margin-bottom: 10px;
            padding-left: 25px;
        }

        #additionalInfoContent li, #colorCustomizationContent li {
            margin-bottom: 5px;
        }

        #additionalInfoContent hr.double-line, #colorCustomizationContent hr.double-line {
            border-style: double;
            border-width: 3px;
            border-color: var(--highlight-green);
            margin: 40px 0;
        }

        /* Estilos para os color pickers */
        .color-picker-group {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .color-picker-group label {
            flex: 1;
            margin-bottom: 0;
        }

        .color-picker-group input[type="color"] {
            width: 80px;
            height: 30px;
            padding: 0;
            border: 1px solid var(--input-border-color);
            border-radius: 4px;
            background: none;
            cursor: pointer;
        }

        /* Estilos para os bot√µes de tema */
        .theme-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }

        .theme-select-button {
            width: auto;
            padding: 10px 15px;
            font-size: 0.9em;
            background-color: var(--clear-button-bg);
            color: var(--clear-button-text);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-transform: uppercase;
            transition: background-color 0.2s ease, color 0.2s ease;
        }

        .theme-select-button:hover {
            filter: brightness(0.9);
        }

        .theme-select-button.active {
            border: 2px solid var(--highlight-green);
            box-shadow: 0 0 8px var(--highlight-green);
        }
    </style>
</head>
<body>
    <!-- Bot√£o de alternar modo removido -->

    <div class="container">
        <div class="logo">
            NEOENERGIA
            <span class="creator-signature">by Gu√≠mel ü§òüèª</span>
        </div>

        <div class="form-group">
            <label for="empresa">EMPRESA:</label>
            <select id="empresa">
                <option value="">Selecione a empresa</option>
                <option value="Coelba">Coelba</option>
                <option value="Celpe">Celpe</option>
                <option value="Cosern">Cosern</option>
                <option value="Elektro">Elektro</option>
                <option value="Brasilia">Bras√≠lia</option>
            </select>
        </div>

        <div class="form-group">
            <label for="nome">NOME:</label>
            <input type="text" id="nome">
        </div>

        <div class="form-group">
            <label for="ucCpf">UC/CPF:</label>
            <input type="text" id="ucCpf">
        </div>

        <div class="form-group">
            <label for="telefone">TELEFONE:</label>
            <input type="tel" id="telefone">
        </div>

        <div class="form-group">
            <label for="motivo">MOTIVO:</label>
            <select id="motivo">
                <option value="">Selecione o motivo</option>
            </select>
        </div>

        <div id="subtipoDerivacaoContainer" style="display: none;">
            <div class="form-group">
                <label for="subtipo">SUBTIPO:</label>
                <select id="subtipo">
                    <option value="">Selecione o subtipo</option>
                </select>
            </div>
            <div class="form-group" id="derivacaoFormGroup" style="display: none;">
                <label for="derivacao">DERIVA√á√ÉO:</label>
                <select id="derivacao">
                    <option value="">Selecione a deriva√ß√£o</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label for="referencia">REFERENCIA:</label>
            <input type="text" id="referencia">
        </div>

        <div class="form-group">
            <label for="observacoes">PROTOCOLO:</label>
            <textarea id="observacoes" placeholder="Insira o protocolo de atendimento ou outras informa√ß√µes."></textarea>
        </div>

        <button class="copy-button" id="copyButton">COPIAR</button>
        <button class="clear-form-button" id="clearFormButton">LIMPAR FORMUL√ÅRIO</button>

        <div id="outputContainer">
            <textarea id="outputContent"></textarea>
        </div>
    </div>

    <!-- Novo Bloco de Notas -->
    <div id="notepadSection" class="info-section">
        <h2>Bloco de Notas</h2>
        <button class="toggle-button" id="toggleNotepadButton">Mostrar/Esconder Bloco</button>
        <button class="clear-button" id="clearNotepadButton">LIMPAR BLOCO</button>
        <textarea id="notepadContent" class="info-content" placeholder="Escreva suas anota√ß√µes aqui..."></textarea>
    </div>
    <!-- Fim do Novo Bloco de Notas -->

    <!-- Nova Se√ß√£o de Senhas Pessoais e Logins -->
    <div id="personalPasswordsSection" class="info-section">
        <h2>SENHAS PESSOAIS E LOGINS</h2>
        <button class="toggle-button" id="togglePersonalPasswordsButton">Mostrar/Esconder Senhas</button>
        <button class="clear-button" id="clearPersonalPasswordsButton">LIMPAR SENHAS</button>
        <textarea id="personalPasswordsContent" class="info-content" placeholder="Registre suas senhas e logins pessoais aqui..."></textarea>
    </div>
    <!-- Fim da Nova Se√ß√£o de Senhas Pessoais e Logins -->

    <div id="historySection" class="info-section">
        <h2>Hist√≥rico de Registros</h2>
        <input type="text" id="historySearchInput" class="search-input" placeholder="Pesquisar no hist√≥rico...">
        <button class="toggle-button" id="toggleHistoryButton">Mostrar/Esconder Hist√≥rico</button>
        <button class="clear-button" id="clearHistoryButton">LIMPAR HIST√ìRICO</button>
        <div id="historyContent" class="info-content"></div> <!-- Alterado de <pre> para <div> -->
    </div>

    <div id="manualLookupSection" class="info-section">
        <h2>Guia de Motivos, Subtipos e Deriva√ß√µes</h2>
        <input type="text" id="manualLookupSearchInput" class="search-input" placeholder="Pesquisar no guia...">
        <button class="toggle-button" id="toggleManualLookupButton">Mostrar/Esconder Guia</button>
        <div id="manualLookupContent" class="info-content"></div> <!-- Alterado de <pre> para <div> -->
    </div>

    <div id="additionalInfoSection" class="info-section">
        <h2>Informa√ß√µes Adicionais e Contatos</h2>
        <input type="text" id="additionalInfoSearchInput" class="search-input" placeholder="Pesquisar nas informa√ß√µes adicionais...">
        <button class="toggle-button" id="toggleAdditionalInfoButton">Mostrar/Esconder Informa√ß√µes</button>
        <div id="additionalInfoContent" class="info-content">
            <h2>CONTATOS POR EMPRESA</h2>
            <h3>CELPE</h3>
            <p>WHATSAPP: (81)3217-6990<br>
            OUVIDORIA: 0800-285-5599<br>
            GRUPOA: 0800-281-2236<br>
            MICROGERA√á√ÉO: 0800-031-1866<br>
            RECLAMA√á√ÉO: 0800-024-2244</p>
            <hr>
            <h3>COELBA</h3>
            <p>WHATSAPP: (71)3370-6350<br>
            OUVIDORIA: 0800-071-7676<br>
            GRUPOA: 0800-284-8080<br>
            MICROGERA√á√ÉO: 0800-071-5509<br>
            RECLAMA√á√ÉO: 0800-276-0116</p>
            <hr>
            <h3>COSERN</h3>
            <p>WHATSAPP: (84)3215-6001<br>
            OUVIDORIA: 0800-084-0404<br>
            GRUPOA: 0800-084-0808<br>
            MICROGERA√á√ÉO: 0800-084-5010<br>
            RECLAMA√á√ÉO: 0800-283-0800</p>
            <hr>
            <h3>ELEKTRO</h3>
            <p>WHATSAPP: (19)2122-1696<br>
            OUVIDORIA: 0800-012-4050<br>
            GRUPOA: 0800-701-0103<br>
            MICROGERA√á√ÉO: 0800-020-1200<br>
            RECLAMA√á√ÉO: 0800-701-0102</p>
            <hr>
            <h3>BRASILIA</h3>
            <p>0800 061 0196.<br>
            WHATSAPP: (61)3465-9318<br>
            OUVIDORIA: 0800-644-6116<br>
            GRUPOA:<br>
            MICROGERA√á√ÉO: 0800-222-2502<br>
            RECLAMA√á√ÉO:</p>
            <hr>
            <p><strong>EQUATORIAL MARANH√ÉO</strong>: 0800 091 0196</p>
            <hr class="double-line">

            <h2>OUTROS CONTATOS IMPORTANTES</h2>
            <h3>CAC ENEL SAO PAULO</h3>
            <p>0800 72 72 120</p>
            <hr>
            <h3>CONTATO ANEEL</h3>
            <p>167</p>
            <hr>
            <h3>CREFAZ</h3>
            <p>0800 052 5052<br>
            VERIFICAR PARCELAS: 0800 052 5051<br>
            whatsapp: (44)3013-9749</p>
            <hr class="double-line">

            <h2>AG√äNCIAS:</h2>
            <h3>COELBA:</h3>
            <p>CREDENCIADA: <a href="https://www.neoenergia.com/documents/d/bahia/enderecos-credenciadas-neoenergia-coelba-020524-pdf" target="_blank">https://www.neoenergia.com/documents/d/bahia/enderecos-credenciadas-neoenergia-coelba-020524-pdf</a><br>
            LOJA: <a href="https://www.neoenergia.com/web/bahia/sua-casa/canais-de-atendimento" target="_blank">https://www.neoenergia.com/web/bahia/sua-casa/canais-de-atendimento</a><br>
            TENSAO: <a href="https://www.neoenergia.com/documents/d/bahia/tensao-fornecimento-nclb-300425" target="_blank">https://www.neoenergia.com/documents/d/bahia/tensao-fornecimento-nclb-300425</a></p>
            <hr>
            <h3>CELP (PERNAMBUCO):</h3>
            <p><a href="https://www.neoenergia.com/documents/d/pernambuco/nper-lojas-1-pdf" target="_blank">https://www.neoenergia.com/documents/d/pernambuco/nper-lojas-1-pdf</a></p>
            <hr>
            <h3>COSERN:</h3>
            <p><a href="https://www.neoenergia.com/documents/d/rn/enderecos-lojas-de-atendimento-neoenergia-cosern-311024-pdf" target="_blank">https://www.neoenergia.com/documents/d/rn/enderecos-lojas-de-atendimento-neoenergia-cosern-311024-pdf</a><br>
            LOJAS: <a href="https://www.neoenergia.com/web/rn/sua-casa/canais-de-atendimento" target="_blank">https://www.neoenergia.com/web/rn/sua-casa/canais-de-atendimento</a></p>
            <hr>
            <h3>ELEKTRO:</h3>
            <p><a href="https://www.neoenergia.com/documents/d/sp/enderecos-atendimento-presencial_site-1-pdf" target="_blank">https://www.neoenergia.com/documents/d/sp/enderecos-atendimento-presencial_site-1-pdf</a></p>
            <hr class="double-line">

            <h2>COMERCIAIS:</h2>
            <h3>COELBA:</h3>
            <p><a href="http://webclientcoelba.neoenergia.net/sap/bc/bsp/sap/crm_ic/" target="_blank">http://webclientcoelba.neoenergia.net/sap/bc/bsp/sap/crm_ic/</a></p>
            <hr>
            <h3>CELP:</h3>
            <p><a href="http://webclientcelpe.neoenergia.net/sap/bc/bsp/sap/crm_ic/" target="_blank">http://webclientcelpe.neoenergia.net/sap/bc/bsp/sap/crm_ic/</a></p>
            <hr>
            <h3>COSERN:</h3>
            <p><a href="http://webclientcosern.neoenergia.net/sap/bc/bsp/sap/crm_ic/" target="_blank">http://webclientcosern.neoenergia.net/sap/bc/bsp/sap/crm_ic/</a></p>
            <hr>
            <h3>ELEKTRO:</h3>
            <p><a href="http://ueappsc.elektro.com.br/elektro.html" target="_blank">http://ueappsc.elektro.com.br/elektro.html</a></p>
            <hr class="double-line">

            <h2>PARCELAMENTO:</h2>
            <h3>COELBA:</h3>
            <p><a href="https://neoenergiacoelba.negocieonline.com.br/callcenter" target="_blank">https://neoenergiacoelba.negocieonline.com.br/callcenter</a><br>
            Login: usuario@callcenter.com.br<br>
            Senha: Callcenter@2023</p>
            <hr class="double-line">

            <h2>ENVIO DE FATURAS:</h2>
            <h3>GMAIL:</h3>
            <p>@gmail.com<br>
            @outlook.com<br>
            @yahoo.com<br>
            @live.com<br>
            @terra.com<br>
            @hotmail.com</p>
            <hr>
            <h3>SMS:</h3>
            <p>@sms.fat.com (elektro)<br>
            @sms.fat (senhas por gmail s√£o os 5 primeiros digitos do cpf ou 5 ultimos)</p>
            <p>(55+DD+N¬∞ DO TELEFONE+@sms.fat.com)</p>
            <hr>
            <h3>WHATSAPP:</h3>
            <p>@faturadigital.whatsapp</p>
            <p>(55+DDD+N¬∞ DO TELEFONE+@faturadigital.whatsapp.com)</p>
            <hr class="double-line">

            <h2>MULTILOGIN: (ACESSO AO MULTILOGIN √â O SEU UE DA ELEKTRO COMO SENHA E LOGIN )</h2>
            <h3>COSERN:</h3>
            <p><a href="https://multilogin-cosern.neoenergia.net/#/login" target="_blank">https://multilogin-cosern.neoenergia.net/#/login</a></p>
            <hr>
            <h3>COELBA:</h3>
            <p><a href="https://multilogin-coelba.neoenergia.net/#/login" target="_blank">https://multilogin-coelba.neoenergia.net/#/login</a></p>
            <hr>
            <h3>CELP/PERNAMBUCO:</h3>
            <p><a href="https://multilogin-pernambuco.neoenergia.net/#/login" target="_blank">https://multilogin-pernambuco.neoenergia.net/#/login</a></p>
            <hr class="double-line">

            <h2>DENUNCIA:</h2>
            <p>TELEFONE: 0800 591 0857<br>
            E-MAIL: neoenergia@canaldedenuncia.com.br<br>
            SITE: <a href="https://www.canalparadenuncia.com.br/neoenergia" target="_blank">www.canalparadenuncia.com.br/neoenergia</a> ou o site da concession√°ria referente ao cliente.</p>
            <hr class="double-line">

            <h2>LINKS √öTEIS E SISTEMAS:</h2>
            <p>RESET DE SENHA: <a href="https://docs.google.com/forms/d/e/1FAIpQLSceWf4ci9sJW13tYf4B3xg2FdzhsutHaT6RZ7wXusrOpG-N5w/viewform" target="_blank">https://docs.google.com/forms/d/e/1FAIpQLSceWf4ci9sJW13tYf4B3xg2FdzhsutHaT6RZ7wXusrOpG-N5w/viewform</a><br>
            COMPLICE OUVIDORIA: <a href="https://aec.becompliance.com/canal-etica/canal-denuncias" target="_blank">https://aec.becompliance.com/canal-etica/canal-denuncias</a><br>
            LINK FACILITA: <a href="https://ceres/FacilitaNeoenergiav2/Guia/Campanha/" target="_blank">https://ceres/FacilitaNeoenergiav2/Guia/Campanha/</a><br>
            LINK CFY: <a href="https://quality.cyf.com/feedbackLogin.php" target="_blank">https://quality.cyf.com/feedbackLogin.php</a><br>
            LINK H.E RELATORIA: <a href="https://paladio/PortalRelatorios/LoginManual.aspx" target="_blank">https://paladio/PortalRelatorios/LoginManual.aspx</a><br>
            LINK NICE: <a href="https://ttvnice-prod4.grupoaec.com.br/pt_BR/group/webstation/home" target="_blank">https://ttvnice-prod4.grupoaec.com.br/pt_BR/group/webstation/home</a><br>
            PORTAL DO CONHECIMENTO: <a href="https://digital-wpress-neoenergia.grupoaec.com.br/wp-login.php?redirect_to=https%3A%2F%2Fdigital-wpress-neoenergia.grupoaec.com.br%2F" target="_blank">https://digital-wpress-neoenergia.grupoaec.com.br/wp-login.php?redirect_to=https%3A%2F%2Fdigital-wpress-neoenergia.grupoaec.com.br%2F</a><br>
            ROBBYSOM: <a href="https://login.microsoftonline.com/8106d8af-7489-49c4-a814-f495064fde59/saml2?SAMLRequest=nZNNb9pAEIb%2FirV3f1GDzQoTUVBVpLRF4PaQSzSsx8lK9q67O07Iv%2B9icMShcOBkaead2ZnnHc8eDk3tvaGxUqucxUHEHuYzC03d8kVHr2qLfzu05DmZsrxP5Kwzimuw0nIFDVpOgu8WPx75KIh4azRpoWvmrVc5exapiAR8SSeRyBKoYJxlI%2Bb9GR50FU5obYdrZQkUuVA0Svw48uO4iFM%2Bjvg4CbI0fWLe5tz6q1SlVC%2B359ifRJZ%2FL4qNv%2Fm1K5i3sBYNuYeXWtmuQbND8yYF%2Ft4%2B5uyVqLU8DAFFYPR%2B%2F2G1CoRuQnAcUJEUQMi8laMhFVA%2F%2FlBT6xepgkYKo62uSKtaKuyLszialBlUfppkUz%2BZisSHLE78KpmOo0lSlTiehkesI3biznsa5gL47T1h2InNr27QIEEJBLPw4oXB5p%2Bu5Xq10bUUH%2FfY%2FE2bBui6Og7iPiJLv%2BqlvFO2RSEriaXzpK71%2B9Kgg5szMh2ycJjsfHtY9pfoPCM83HWJS920YKQ9WoYHEDSwvmy8rB3KLVb3kL8pE1wcW7vwxn3etSmPh4zCLVYYcCy0obMz%2F5tnfspdwfGZvfxb5%2F8A&RelayState=operacao&sso_reload=true" target="_blank">https://login.microsoftonline.com/8106d8af-7489-49c4-a814-f495064fde59/saml2?SAMLRequest=nZNNb9pAEIb%2FirV3f1GDzQoTUVBVpLRF4PaQSzSsx8lK9q67O07Iv%2B9icMShcOBkaead2ZnnHc8eDk3tvaGxUqucxUHEHuYzC03d8kVHr2qLfzu05DmZsrxP5Kwzimuw0nIFDVpOgu8WPx75KIh4azRpoWvmrVc5exapiAR8SSeRyBKoYJxlI%2Bb9GR50FU5obYdrZQkUuVA0Svw48uO4iFM%2Bjvg4CbI0fWLe5tz6q1SlVC%2B359ifRJZ%2FL4qNv%2Fm1K5i3sBYNuYeXWtmuQbND8yYF%2Ft4%2B5uyVqLU8DAFFYPR%2B%2F2G1CoRuQnAcUJEUQMi8laMhFVA%2F%2FlBT6xepgkYKo62uSKtaKuyLszialBlUfppkUz%2BZisSHLE78KpmOo0lSlTiehkesI3biznsa5gL47T1h2InNr27QIEEJBLPw4oXB5p%2Bu5Xq10bUUH%2FfY%2FE2bBui6Og7iPiJLv%2BqlvFO2RSEriaXzpK71%2B9Kgg5szMh2ycJjsfHtY9pfoPCM83HWJS920YKQ9WoYHEDSwvmy8rB3KLVb3kL8pE1wcW7vwxn3etSmPh4zCLVYYcCy0obMz%2F5tnfspdwfGZvfxb5%2F8A&RelayState=operacao&sso_reload=true</a><br>
            PORTAL PESSOAL: <a href="https://pegasus/Portal_Pessoal/Acesso/Login?returnUrl=%2FPortal_P" target="_blank">https://pegasus/Portal_Pessoal/Acesso/Login?returnUrl=%2FPortal_P</a><br>
            google: <a href="https://www.google.com/" target="_blank">https://www.google.com/</a><br>
            RECEITA FEDERAL: <a href="https://servicos.receita.fazenda.gov.br/Servicos/CPF/ConsultaSituacao/ConsultaPublica.asp" target="_blank">https://servicos.receita.fazenda.gov.br/Servicos/CPF/ConsultaSituacao/ConsultaPublica.asp</a><br>
            RECEITA CNPJ: <a href="https://consultacnpj.com/" target="_blank">https://consultacnpj.com/</a><br>
            SALES-FORCE: <a href="https://neoenergia2021.lightning.force.com/lightning/page/home" target="_blank">https://neoenergia2021.lightning.force.com/lightning/page/home</a><br>
            GOGLE LIVROS: <a href="https://books.google.com.br/" target="_blank">https://books.google.com.br/</a></p>
            <hr class="double-line">

            <h2>LUGARES QUE ATENDEM ILUMINA√á√ÉO PUBLICA:</h2>
            <h3>ILUMINA√á√ÉO P√öBLICA CIDADES (CELPE):</h3>
            <ul>
                <li>PANELAS</li>
                <li>SANTA CRUZ DO CAPIBARIBE</li>
                <li>AGRESTINA</li>
                <li>GRAVAT√Å</li>
                <li>SERRA TALHADA</li>
            </ul>
            <h3>ILUMINA√á√ÉO P√öBLICA CIDADES (ELEKTRO):</h3>
            <ul>
                <li>CAJATI -REDENCAO DA SERRA</li>
                <li>PARIQUERA - AURIFLAMA</li>
                <li>A√á√ö -IRACEMAPOLIS</li>
                <li>ILHA COMPRIDA -EUCLIDES DA CUNHA</li>
                <li>ARARAS -ITAPEVA</li>
                <li>PEDRO DE TOLEDO</li>
            </ul>
            <hr class="double-line">

            <h2>TABELA PARA C√ÅLCULO DA CCIP:</h2>
            <p>nova<br>
            Consumo de at√© 100KWH por m√™s ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶. 1,00% da TCIP<br>
            Consumo de 101 a 200KWH por m√™s ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ 4,00% da TCIP<br>
            Consumo de 201 a 300KWH por m√™s ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ 6,00% da TCIP<br>
            Consumo de 301 a 500KWH por m√™s ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶8,00% da TCIP<br>
            Consumo de mais de 500KWH por m√™s ‚Ä¶‚Ä¶‚Ä¶10,00% da TCIP<br>
            Im√≥vel sem medidor de consumo de energia por ano‚Ä¶. 60,00% da TCIP</p>
            <hr class="double-line">

            <h2>ARTIGOS REGULAT√ìRIOS:</h2>
            <p><strong>Art.73</strong> Que √© uma autua√ß√£o sobre uso indevido de carga ou liga√ß√£o direta.</p>
            <p><strong>Art. 111</strong> √© a leitura por media por causa de calamidade regulamentada por √≥rg√£o competente junto a Aneel (tipo pandemia)</p>
            <p><strong>Art. 113</strong> √© por causa de faturamento de valores incorretos</p>
            <p><strong>Art.115</strong> trata de um consumo q ocorreu e n√£o foi registrado por defeito do medidor ou procedimento que impediu medi√ß√£o<br>
            correta (que no caso gera aquele parcelamento autom√°ticamente para cobran√ßa)</p>
            <p>Em hist√≥rico de consumo e leitura (sap) ou quadro resumo (ue) nos deparamos com essas anota√ß√µes.<br>
            <strong>IMPORTANT√çSSIMO</strong> Essas informa√ß√µes devem ser repassadas com muita cautela,</p>
            <p>acima foram resumidas apenas para uma compreens√£o superficial do que se trata,<br>
            mas que os dota de conhecimento suficiente para informa√ß√£o do cliente.</p>
            <p>Se atenderem um cliente com o caso do art 73 n√£o seja imprudente dizendo ao cliente: Ahhh Senhor isso √© por causa de um gato!<br>
            Voc√™ pode falar por exemplo: Senhor o art 73 fala sobre irregularidades no uso da energia,<br>
            uma nota da inspe√ß√£o com mais detalhes, ou foi entregue ao Senhor no ato,<br>
            ou enviado para seus meios de comunica√ß√£o cadastrados nessa unidade.</p>
            <p>Percebem a diferen√ßa de abordagem? Lembrem-se tamb√©m, p√≥s argumenta√ß√µes por sua parte,<br>
            se o cliente quiser reclamar ou contestar √© um direito tbm previsto em resolu√ß√£o que ele possui,<br>
            ent√£o valide com seu supervisor a transfer√™ncia para CEC, tabulando o caso com as informa√ß√µes do caso antes de transferir.</p>
            <hr class="double-line">

            <h2>CLIENTES DE MICRO GERA√á√ÉO (CONTATO DE RECLAMA√á√ÉO):</h2>
            <p>Celpe - <a href="mailto:clientescorporativoscelpe@neoenergia.com">clientescorporativoscelpe@neoenergia.com</a><br>
            Coelba - <a href="mailto:captacaodeclientes.coelba@neoenergia.com">captacaodeclientes.coelba@neoenergia.com</a><br>
            Cosern - <a href="mailto:grandesclientes.cosern@neoenergia.com">grandesclientes.cosern@neoenergia.com</a><br>
            Elektro - <a href="mailto:atendimento.personalizado@elektro.com.br">atendimento.personalizado@elektro.com.br</a></p>
            <hr class="double-line">

            <h2>RESSARCIMENTO DE DANOS:</h2>
            <p>RELATO DO OCORRIDO:<br>
            DATA E HORARIO DO INICIO DO OCORRIDO:<br>
            DATA E HORARIO DO FINAL DO OCORRIDO:<br>
            REFERENCIA:<br>
            TELEFONE PARA CONTATO:<br>
            EMAIL DE CONTATO:<br>
            MEIO DE COMUNICA√á√ÉO ESCOLHIDO:<br>
            LISTA DE EQUIPAMENTOS DANIFICADOS: MARCA- MODELO- TEMPO- USO<br>
            HOUVE CONSERTO:</p>
            <hr class="double-line">

            <h2>BAIXA RENDA:</h2>
            <h3>MOTIVOS POR N√ÉO TER REALIZADO:</h3>
            <ul>
                <li>Inconsist√™ncias cadastrais no Cadastro √önico ou na composi√ß√£o familiar;</li>
                <li>Cadastro √∫nico n√£o atualizado;</li>
                <li>Renda maior que a permitida;</li>
                <li>Benef√≠cio da assist√™ncia social sem direito;</li>
                <li>Recebimento do benef√≠cio em mais de uma unidade consumidora;</li>
                <li>N√£o localizada a inscri√ß√£o nos cadastros do governo federal;</li>
                <li>Exclus√£o dos cadastros do governo federal.</li>
            </ul>
            <p>-> 0 a 30kw: 65% de desconto;<br>
            -> 31 a 100kw: 40% de desconto;<br>
            -> 101 a 220kw: 10% de desconto;<br>
            -> acima de 220kw: n√£o h√° desconto aplicado</p>
            <hr class="double-line">

            <h2>LIGA√á√ÉO NOVA:</h2>
            <p>MONO: 1K - 10K<br>
            BI: 12K-25K<br>
            TRI: 26K-75K</p>
            <h3>Neoenergia Coelba (Procedimento exclusivo)</h3>
            <p>Entre no link abaixo, filtre a cidade e preencha o espa√ßo do medidor com:<br>
            Y quando a tens√£o √© predominante 127<br>
            x quando a tens√£o √© predominante 220<br>
            <a href="https://www.neoenergia.com/web/bahia/sua-casa/tensao-de-fornecimento" target="_blank">https://www.neoenergia.com/web/bahia/sua-casa/tensao-de-fornecimento</a></p>
            <hr>
            <h3>Neoenergia Pernambuco</h3>
            <p>Caso ele solicite liga√ß√£o monof√°sica deixar em branco o local medidor<br>
            caso ele solicite trif√°sico se preencher√° com o preenchimento com o ‚ÄúX‚Äù</p>
            <hr>
            <h3>Neoenergia Cosern</h3>
            <p>sejam monof√°sicas ou trif√°sicas preencha com um ‚ÄúX‚Äù no campo medidor.</p>
            <hr class="double-line">

            <h2>ATENDIMENTO PARA DEFICIENTES VISUAIS:</h2>
            <p>COELBA: 0800 281 0142<br>
            CELP: 0800 281 0142<br>
            COSERN: 0800 281 0142<br>
            ELEKTRO: 0800 701 0155<br>
            BRASILIA: 0800 701 0155</p>
            <hr class="double-line">

            <h2>PRAZOS:</h2>
            <p>TELEGRAVA√á√ÉO: S√ÉO 5 DIAS UTEIS<br>
            RECLAMA√á√ÉO: 5 DIAS UTEIS SEM A VISITA E 10 DIAS SE NECESSARIO PRECISAR DA VISITA TECNICA<br>
            SERASA: AO EFETUAR O PAGAMENTO S√ÉO EM TONRO 15 DIAS UTEIS PRA SAIR DO SERASA, CONTENDO 12 DIAS PRA SAIR DO SERASA<br>
            E 3 DO SISTEMA</p>
            <hr class="double-line">

            <h2>COMO CALCULAR O VALOR DA FATURA DOS APARELHOS:</h2>
            <p>Para calcular o consumo de energia em kWh de qualquer equipamento el√©trico,<br>
            basta multiplicar a sua pot√™ncia em Watt (W)<br>
            pelo tempo de uso em horas (h) e dividir o resultado por 1.000.</p>
            <p>Exemplo: um aparelho de som de 300W, ligado por 5 horas, ir√° consumir 1.500W, equivalente a 1,5 kWh.</p>
            <p>Depois, √© s√≥ multiplicar esse consumo di√°rio pelos dias do m√™s para calcular o consumo el√©trico mensal do equipamento.<br>
            Ou seja, em 30 dias, o aparelho de som consumiu 45 kWh.</p>
            <hr>
            <h2>TARIFAS:</h2>
            <p>O valor cobrado mensalmente pelo seu consumo de energia √© calculado pela tarifa de energia vigente da sua distribuidora,<br>
            que pode ter o acr√©scimo das bandeiras tarif√°rias, mais os impostos e encargos que voc√™ paga.</p>
            <p>J√° os impostos s√£o os tributos definidos pelo governo, como Imposto sobre Circula√ß√£o de Mercadorias e Servi√ßos (ICMS),<br>
            Programa de Integra√ß√£o Social (PIS) e Contribui√ß√£o para o Financiamento da Seguridade Social (Cofins).</p>
            <hr>
            <h2>C√ÅLCULO DE KWH:</h2>
            <p>Se a tarifa da distribuidora da sua regi√£o for de, por exemplo, R$ 0,80 pelo kWh e voc√™ consumir 100 kWh,<br>
            voc√™ pagar√° R$ 80 por esse consumo. Tamb√©m a t√≠tulo de exemplo,<br>
            vamos considerar que o valor dos impostos √© de R$ 0,20 por kWh.<br>
            Nesse caso, o total dos impostos da sua conta seria de R$ 20</p>
            <p>Fazendo a soma da tarifa + impostos, o valor final cobrado na sua conta mensal de energia seria de R$ 100.</p>
            <hr>
            <h2>ILUMINA√á√ÉO P√öBLICA (C√°lculo):</h2>
            <p>Por√©m, isso n√£o √© tudo! O consumidor ainda precisa pagar um valor correspondente √† contribui√ß√£o para a ilumina√ß√£o p√∫blica,<br>
            que varia de acordo com o munic√≠pio.</p>
            <p>Vamos utilizar um exemplo para voc√™ entender melhor: digamos que o valor total da sua conta foi de R$ 100<br>
            (j√° com a tarifa, impostos e bandeira vigente) e voc√™ mora em um resid√™ncia na cidade de S√£o Paulo</p>
            <p>Como, nessa cidade, o valor da contribui√ß√£o para ilumina√ß√£o p√∫blica √© de R$ 9,66 para esse tipo de im√≥vel,<br>
            o valor total da sua conta mensal seria de R$ 109,66.</p>
            <hr>
            <h2>TAXAS DA ILUMINA√á√ÉO P√öBLICA:</h2>
            <p>4,00% (quatro por cento) do contribuinte cujo im√≥vel dispender de 101 a 200 KWh por m√™s;<br>
            5,50% (cinco e meio por cento) do contribuinte cujo im√≥vel dispender de 201 a 300 KWh por m√™s;<br>
            7,00% (sete por cento) do contribuinte cujo im√≥vel dispender acima de 301 KWh por m√™s.</p>
            <p>(INFORMA√á√ïES DO SITE: <a href="https://www.portalsolar.com.br/como-calcular-o-consumo-de-energia-em-kwh" target="_blank">https://www.portalsolar.com.br/como-calcular-o-consumo-de-energia-em-kwh</a>)</p>
            <hr class="double-line">

            <h2>FOP FPL 9 GERAR NUMERA√á√ÉO DE BARRAS PELO DEBITO AUTOMATICO NA NORDESTE EM 10 PASSOS:</h2>
            <p>Quando voc√™ tenta enviar para o cliente a fatura no debito automatico, geralmente vai aparecer dois erros:</p>
            <ul>
                <li>Ficar tudo em branco e n√£o confimar a segunda via</li>
                <li>Acesso n√£o autorizado...</li>
            </ul>
            <p>Nesses casos: vai no fop FPL9=</p>
            <ol>
                <li>vai colocar o " Cta.contrato " e apertar enter.</li>
                <li>vai clicar no nome "VENCIMENTO" 1 vez.</li>
                <li>la em cima vai clicar em "PROCURAR".</li>
                <li>colocar a data do vencimento das faturas sem os pontos. EX: 11.11.2023 = 11112023. E confimar (‚úî).</li>
                <li>vai em "MENU" mas em baixo selecionar "AMBIENTE" e em frente "GERAR FORMULARIO DE PAGAMENTO"</li>
                <li>na nova aba voce vai clicar na pasta do lado dos " &lt; &gt; " e selecionar "PAR√ÇMENTROS IMPRESS√ÉO"</li>
                <li>No fop "Formul.aplica√ß√£o" vai clicar no " ZCFI_CA_FATURA_SD " e confirma (‚úî)</li>
                <li>No fop "Dispositivo de sa√≠da" vai clicar pra procurar e na nova aba clicar no (‚úî)<br>
                em baixo que vai aparecer varias op√ß√µes √© so clica no " PDFWEB " e confirma (‚úî)</li>
                <li>Apos isso confirma, na seta ao lado do Dispositivo de sa√≠da que aparecer outra aba, apos isso<br>
                selecionar "Pr√©-visualiza√ß√£o", apos confirma sera redirecionado a aba anterior.</li>
                <li>√â so clicar na pasta do lado do (‚úî) que vai abrir a fatura automatica mandar selecionar para abrir. üòâ</li>
            </ol>
            <hr class="double-line">

            <h2>N√öMERO DA PREFEITURA DE ILUMINA√á√ÉO PUBLICA (PESQUISADO NO GOOGLE)</h2>
            <h3>CELP:</h3>
            <p>JABOATAO DOS GUARARAPES: (81) 99232-5280<br>
            PAULISTA: 0800.000.4279<br>
            ABREU E LIMA: 0800 002 0220<br>
            CARUARU: 0800 666 0080<br>
            CABO DE SANTO AGOSTINHO: 81 99160-5845 ou 3521-6698 e pelo whatsapp 81 98870-4353<br>
            OLINDA: 0800 778 7272<br>
            RECIFE: 156<br>
            BEZERROS Secretaria de Infraestrutura :(81) 3728-6735</p>
            <hr>
            <h3>COELBA:</h3>
            <p>SALVADOR: 156<br>
            CAMACARI: 0800 284 0064<br>
            LAURO DE FREITAS: 080 721 0112</p>
            <hr>
            <h3>ELEKTRO:</h3>
            <p>GERAL: 0800 779 0156 (SAO PAULO 0800175717)<br>
            GUARUJA: 0800 608 1053<br>
            MOGI-GUA√áU: 0800 770 5676<br>
            FERNANDOPOLIS: 0800-772-4550 =WHATSAPP: (17)99728-4550<br>
            PERUIBE 0800-000-0209<br>
            GAST√ÉO VIDIGAL- 0800175717, pode ligar para o 153 e digitar a op√ß√£o 3<br>
            PORTO FERREIRA:0800-777-9541 . WHATSAPP:(19) 9 7145-4586<br>
            TRES LAGOAS WHATSAPP: (67) 2104-0271<br>
            LIMEIRA: 156<br>
            FRANCISCO MORATO: 0800-806-4641.<br>
            Itanha√©m: 0800 806 4641<br>
            ANDRADINA: (18) 99748-7850<br>
            TEODORO SAMPAIO: (18) 3282-1224<br>
            OUROESTE: 0800-190-5000 WHATS:(17)99119-8069<br>
            RIO CLARO: 3526-7127-WHATS:(19) 9 9495-9124-SITE:¬†<a href="http://www.rioclaro.sp.gov.br" target="_blank">www.rioclaro.sp.gov.br</a> .</p>
            <h3>LEME: G-Energy:</h3>
            <p>Telefone:¬†0800 777 9541<br>
            WhatsApp:¬†(19) 99661-4123 (apenas mensagens)<br>
            Site:¬†<a href="https://www.genergy.com.br/genergy-manutencao.html" target="_blank">www.genergy.com.br/genergy-manutencao.html</a></p>
            <h3>Prefeitura de Leme:</h3>
            <p>Telefone:¬†3097-1000<br>
            Secretaria de Obras e Planejamento Urbano:¬†Rua Dr.¬†Armando de Sales Oliveira, 1085 ‚Äì 4¬∫ andar</p>
            <h3>Prefeitura de S√£o Jo√£o da Boa Vista:</h3>
            <p>Central: (19) 3634-1000<br>
            Ouvidoria: 0800 7730156</p>
            <hr>
            <h3>COSERN:</h3>
            <p>NATAL: 0800 281 8980<br>
            CEARA MIRIM: (84) 3274-5916 WHATS-(84) 99119-2386<br>
            CAICO: (84) 99118-0037 (tambem serve para whatsapp)<br>
            PARNAMIRIM: 0800-2816400<br>
            SAO GONCALO DO AMARANTE: (84) 3278-3242 ,(84) 99918-9995 /(84) 99621-6999 (WhatsApp).<br>
            MOSSORO: (84) 99655-6965</p>
            <hr class="double-line">
            <p><strong>Imp.Som/Dim-C/Impost:</strong><br>
            Esse termo refere-se a cobran√ßa residual ao trocar o medidor convencional em unidades consumidoras que acabaram de implantar seu sistema de Micro ou Minigera√ß√£o</p>
        </div>
    </div>

    <!-- Nova Se√ß√£o de Personaliza√ß√£o de Cores -->
    <div id="colorCustomizationSection" class="info-section">
        <h2>Personaliza√ß√£o de Cores</h2>
        <button class="toggle-button" id="toggleColorCustomizationButton">Mostrar/Esconder Personaliza√ß√£o</button>
        <div id="colorCustomizationContent" class="info-content">
            <p>Altere as cores dos elementos do formul√°rio ao seu gosto. Suas escolhas ser√£o salvas automaticamente.</p>

            <hr class="double-line">
            <div id="themePresets" class="theme-buttons-container">
                <h3>Temas Pr√©-definidos:</h3>
                <div class="theme-buttons">
                    <button class="clear-form-button theme-select-button" data-theme="default-dark">Padr√£o Escuro</button>
                    <button class="clear-form-button theme-select-button" data-theme="default-light">Padr√£o Claro</button>
                    <button class="clear-form-button theme-select-button" data-theme="azul-oceano">Azul Oceano</button>
                    <button class="clear-form-button theme-select-button" data-theme="azul-eletrico">Azul El√©trico</button>
                    <button class="clear-form-button theme-select-button" data-theme="noite-estrelada">Noite Estrelada</button>
                </div>
                <hr>
            </div>

            <div id="colorPickers" class="color-pickers-container">
                <div class="color-picker-group form-group">
                    <label for="bgColorPicker">Cor de Fundo Principal:</label>
                    <input type="color" id="bgColorPicker" value="#000000">
                </div>
                <div class="color-picker-group form-group">
                    <label for="containerBgColorPicker">Cor de Fundo dos Blocos:</label>
                    <input type="color" id="containerBgColorPicker" value="#000000">
                </div>
                <div class="color-picker-group form-group">
                    <label for="textColorPicker">Cor do Texto Principal:</label>
                    <input type="color" id="textColorPicker" value="#FFFFFF">
                </div>
                <div class="color-picker-group form-group">
                    <label for="labelColorPicker">Cor das Labels:</label>
                    <input type="color" id="labelColorPicker" value="#EEEEEE">
                </div>
                <div class="color-picker-group form-group">
                    <label for="inputBgColorPicker">Fundo dos Campos de Entrada:</label>
                    <input type="color" id="inputBgColorPicker" value="#444444">
                </div>
                <div class="color-picker-group form-group">
                    <label for="inputTextBorderColorPicker">Borda dos Campos de Entrada:</label>
                    <input type="color" id="inputTextBorderColorPicker" value="#555555">
                </div>
                <div class="color-picker-group form-group">
                    <label for="inputTextColorPicker">Cor do Texto dos Campos de Entrada:</label>
                    <input type="color" id="inputTextColorPicker" value="#FFFFFF">
                </div>
                <div class="color-picker-group form-group">
                    <label for="copyBtnBgColorPicker">Fundo do Bot√£o Copiar/Alternar:</label>
                    <input type="color" id="copyBtnBgColorPicker" value="#4CAF50">
                </div>
                <div class="color-picker-group form-group">
                    <label for="copyBtnTextColorPicker">Cor do Texto do Bot√£o Copiar/Alternar:</label>
                    <input type="color" id="copyBtnTextColorPicker" value="#FFFFFF">
                </div>
                <div class="color-picker-group form-group">
                    <label for="clearBtnBgColorPicker">Fundo do Bot√£o Limpar:</label>
                    <input type="color" id="clearBtnBgColorPicker" value="#e0e0e0">
                </div>
                <div class="color-picker-group form-group">
                    <label for="clearBtnTextColorPicker">Cor do Texto do Bot√£o Limpar:</label>
                    <input type="color" id="clearBtnTextColorPicker" value="#000000">
                </div>
                <div class="color-picker-group form-group">
                    <label for="outputBgColorPicker">Fundo da √Årea de Sa√≠da/Conte√∫do:</label>
                    <input type="color" id="outputBgColorPicker" value="#222222">
                </div>
                <div class="color-picker-group form-group">
                    <label for="outputTextColorPicker">Cor do Texto da √Årea de Sa√≠da/Conte√∫do:</label>
                    <input type="color" id="outputTextColorPicker" value="#FFFFFF">
                </div>
                <div class="color-picker-group form-group">
                    <label for="outputBorderColorPicker">Borda da √Årea de Sa√≠da/Conte√∫do:</label>
                    <input type="color" id="outputBorderColorPicker" value="#555555">
                </div>
                <hr>
            </div>

            <!-- Transparency Slider -->
            <div class="form-group">
                <label for="transparencySlider">Transpar√™ncia dos Campos:</label>
                <input type="range" id="transparencySlider" min="0" max="1" step="0.05" value="0.7">
                <span id="transparencyValue">70%</span>
            </div>
            <hr>

            <div id="backgroundImageControls" class="form-group">
                <h3>Imagem de Fundo (Papel de Parede):</h3>
                <p style="font-size: 0.85em; color: var(--label-color);">Resolu√ß√£o recomendada: 1920x1080 pixels (Full HD) ou superior para melhor qualidade. Evite imagens muito grandes (acima de 5MB) para melhor performance.</p>
                <label for="backgroundImageInput">Selecione uma imagem:</label>
                <input type="file" id="backgroundImageInput" accept="image/*">
                <button class="clear-form-button" id="clearBackgroundImageButton" style="margin-top: 10px;">Limpar Imagem de Fundo</button>
            </div>
            <hr>

            <button class="clear-form-button" id="randomColorsButton">Cores Aleat√≥rias</button>
            <button class="clear-form-button" id="resetColorsButton">Restaurar Padr√£o do Tema</button>
        </div>
    </div>
    <!-- Fim da Se√ß√£o de Personaliza√ß√£o de Cores -->


    <!-- Estrutura do Modal Personalizado -->
    <div id="customAlertModal" class="custom-modal-overlay" style="display: none;">
        <div class="custom-modal">
            <p id="customAlertMessage"></p>
            <div class="modal-buttons">
                <button onclick="hideCustomAlert()">OK</button>
            </div>
        </div>
    </div>

    <div id="customConfirmModal" class="custom-modal-overlay" style="display: none;">
        <div class="custom-modal">
            <p id="customConfirmMessage"></p>
            <div class="modal-buttons">
                <button id="confirmYesButton">Sim</button>
                <button id="confirmNoButton" class="cancel">N√£o</button>
            </div>
        </div>
    </div>

    <!-- Mensagem de Feedback de C√≥pia -->
    <div id="copyFeedback">Copiado!</div>

    <script>
        // Objeto de dados para os motivos, subtipos e deriva√ß√µes
        const motivosData = {
            "UNIDADE": {
                "INFORMA√á√ïES": "cliente entra em contato solicitando informa√ß√µes sobre sua unidade consumidora. verificado em sistema repassado de acordo."
            },
            "DATA BOA": {
                "VENCIMENTO": "cliente entra em contato para solicitar a troca da data de faturamento. sondado todos os dados, modificado com sucesso."
            },
            "VERBALIZAR CODIGO DE BARRAS": {
                "CODIGO DE BARRAS": "cliente deseja que o agente verbalize codigo de barras da fatura do m√™s __. Conforme todos os dados, verbalizado de acordo."
            },
            "ENVIO DE SEGUNDA VIA": {
                "ENVIADO": "cliente solicita envio das faturas em aberto. Sondado todos os dados, enviado de acordo.",
                "NAO ENVIADO": "cliente solicita envio das faturas em aberto. Sondado todos os dados, n√£o enviado pois n√£o era o titular/confirmou todos os dados.",
                "BOLETO": "cliente solicita envio dos boleto em aberto. Sondado todos os dados, recomendo aguarda."
            },
            "REATIVA√á√ÉO": {
                "FEITO": "cliente entra em contato solicitando reativa√ß√£o de sua unidade consumidora. Sondado todos os dados, realizado de acordo",
                "NAO ERA O TITULAR": "cliente entra em contato solicitando reativa√ß√£o de sua unidade consumidora. Sondado todos os dados, n√£o realizado pois n√£o era o titular.",
                "DEBITOS": "cliente entra em contato solicitando reativa√ß√£o de sua unidade consumidora. Sondado todos os dados, nao realizado pois continha debitos.",
                "REATIVA√á√ÉO COM TROCA": "Cliente deseja reativa√ß√£o com troca de titularidade, le informado de acordo que so na loja fisica ou site",
                "CNPJ": "Cliente solicita reativa√ß√£o, mas √© um cnpj, servi√ßo n√£o realizado."
            },
            "INFORMA√á√ïES": { 
                "TROCA DE TITULARIDADE": "cliente entra em contato solicitando informa√ß√µes sobre troca de titularidade, repassado as informa√ß√µes, informado utilizar tanto pelos canais digitais, e recomendado em casos espec√≠ficos s√≥ na loja f√≠sica.",
                "PARCELAMENTO INFO": "Cliente entra em contato para saber informa√ß√µes sobre parcelamento, foi sugerido o link do parcelamento ao mesmo, no qual foi enviado por SMS.",
                "DEBITOS": "cliente entra em contato solicitando informa√ß√µes sobre seus debitos. Sondado todos os dados, verificado em sistema, repassado as informa√ß√µes de acordo.",
                "LIGA√á√ÉO NOVA": "cliente entra em contato solicitando informa√ß√µes de liga√ß√£o nova, verificado em sistema, repassado de acordo."
            },
            "FATURA POR GMAIL": {
                "CADRASTADO": "Cliente solicita cadastro de fatura por email. Sodando todos os dados, colocado de acordo.",
                "DESCADRASTRO": "cliente solicita descadastro de fatura por gmail, sondado todos os dados, procedimento feito de acordo.",
                "NAO ERA O TITULAR": "Cliente solicita cadrasto de fatura por email. N√£o foi realizado pois n√£o era o titular/ n√£o confirmou todos os dados.",
                "APLICATIVO": "cliente esta tentando entrar no novo aplicativo, e pede para resetar a senha, mas n√£o esta recebendo totem por gmail."
            },
            "OSCILA√á√ÉO": {
                "GERAL": "cliente entra em contato informa que tanto a sua resid√™ncia como a vizinhan√ßa consta com oscila√ß√£o de energia. Nota gerada de acordo",
                "INDIVUAL": "cliente entra em contato informando que a sua residencia consta com oscila√ß√£o de energia, verificado os scripts, nota gerada de acordo."
            },
            "ATUALIZA√á√ÉO CADRASTAL": {
                "ATUALIZADO": "Cliente entra em contato solicitando atualiza√ßao cadrastal. Sondado todos os dados, modificado de acordo"
            },
            "CARGA": {
                "REALIZADO": "cliente solicita altera√ß√£o de carga para ____. sondado todos os dados, realizado de acordo.",
                "DEBITO EM ATRASO": "cliente solicita altera√ß√£o de carga.N√£o realizado pos continha debitos em aberto."
            },
            "FALTA DE ENERGIA": {
                "GERAL": "falta de energia geral desde √†s 11_ sem motivos aparentes.",
                "INDIVIDUAL": "Cliente informa falta de energia somente em sua unidade desde √†s ___ sem motivos aparentes. ja foi realizado verifica√ß√£o dos scripts. Nota gerada de acordo.",
                "NOTA J√Å GERADA": "Cliente informa falta de energia, por√©m, j√° continha nota gerada anteriormente em sistema. Informado, repassado a previs√£o e orientado aguardar.",
                "ITERNO": "Cliente informa falta de energia somente em sua unidade, porem era problema interno, nota n√£o gerada.",
                "SUSPENSA": "Cliente informa falta de energia somente em sua unidade, porem esta suspensa.",
                "PREVIS√ÉO": "Cliente deseja informa√ß√£o de falta de energia. Informado, repassado a previs√£o e orientado aguardar."
            },
            "FALTA DE FASE": {
                "GERAL": "Cliente informa falta de fase geral desde √†s ___ sem motivos aparentes. J√° foi realizado a verifica√ß√£o dos scripts. Nota gerada de acordo.",
                "INDIVIDUAL": "falta de fase, ja solicitou um eletricista particular, o mesmo informa que √© externo.",
                "NOTA EM ABERTO": "Cliente informa fase por√©m, j√° continha nota gerada anteriormente em sistema. Informado, repassado a previs√£o e orientado aguardar."
            },
            "RISCOS A VIDA !!!!!": {
                "CONDUTOR PARTIDO/ INCENDIO": "cliente informa que a um ___na sua localidade. √© oriatado a n√£o se aproximar e se possivel isolar area. nota gerada e repassada para supervisor para priorizar"
            },
            "PODA DE ARVORE": {
                "REALIZADO": "Cliente entra em contato para informar que proximo a sua unidade ha uma arvore que precisa ser polda, pois esta proxima dos condutores de energia, nota gerada de acordo",
                "PREFEITURA": "Cliente entra em contato para informar que proximo a sua unidade ha uma arvore que precisa ser polda, pois esta proxima dos condutores de energia. Foi informado a mesma que e necessario entrar em contato com a prefeitura de seu municipio para que eles possam abrir o chamado."
            },
            "BAIXA RENDA": {
                "CADASTRO TARIFA SOCIAL ": { 
                    "REALIZADO": "Cliente deseja que seja inclu√≠do o n√∫mero do NIS em sua unidade para receber o desconto do baixa renda. Feito de acordo.",
                    "INFORMA√á√ÉO SOBRE TARIFA SOCIAL:": "Cliente entra em contato para saber se ja tem o baixa renda incluido em seu cadastro. Foi informado a mesma que a partir das proximas faturas seus debitos virao com a tarifa social incluidos na mesma"
                }
            },
            "ACOMPANHAMENTO DE NOTA": {
                "INFORMA√á√ïES NOTA NORMAL": "Cliente solicita informa√ß√µes sobre o andamento da sua nota de ___. Foi informado, repassado o prazo e orientado aguardar.",
                "EM ATRASO": "Cliente solicita informa√ß√µes sobre o andamento da sua nota de ___. Foi verificado em sistema que sua nota estaria em atraso por cerca de ___. Transferido com valida√ß√£o.",
                "REALIZADA": "Cliente solicita informa√ß√µes sobre o andamento da sua nota de ___. Foi verificado e informado que a nota j√° teria sido atendida. Orientado a verificar se a informa√ß√£o de sistema procede.",
                "RETIDA": "Cliente solicita informa√ß√µes sobre o andamento da sua nota de ___. Foi informado que a nota de momento estaria RETIDA. O mesmo informa que os problemas j√° foram contornados. Nota reliberada de acordo.",
                "VISITADO E NAO REALIZADO": "Cliente solicita informa√ß√µes sobre o andamento da sua nota de ___. Foi informado que sua nota de momento estaria VNRE e o mesmo teria que realizar o pedido novamente."
            },
            "CANCELAR NOTA": {
                "FALTA DE ENERGIA": "cliente entra em contato afirmando que anteriormente solicitou uma falta de energia porem retornou a liga√ß√£o afirmando que o problema seria interno e deseja cancelar a DEMANDA",
                "CANCELAR NOTA": "cliente entra em contato solicitando o cancelamento da nota ___,sondado os dados realizado de acordo",
                "SERVI√áO DE TERCEIROS": "cliente entra em contato para cancelar o servi√ßo ___. sondado os dados realizado de acordo"
            },
            "RELIGA√á√ÉO": {
                "GERADO": "cliente deseja religa√ß√£o de sua unidade. O mesmo informa que pagou as faturas e tem os comprovantes em m√£os. Nota gerada de acordo.",
                "N√ÉO FEITA": "Cliente solicita religa√ß√£o da unidade, por√©m, n√£o foi efetuado o pagamento de todos os d√©bitos que est√£o em atraso. Foi orientado realizar os pagamentos e ap√≥s isso solicitar novamente a religa√ß√£o.",
                "NOTA J√Å EM SISTEMA": "Cliente solicita religa√ß√£o, por√©m, j√° havia nota aberta em sistema. Foi orientado aguardar o prazo do servi√ßo."
            },
            "AUTO LEITURA": {
                "REALIZADO": "Cliente entra em contato para passar auto-leitura. Foi informado a mesma o consumo em KW e a mesma desejou registrar.",
                "FORA DE DATA DE FATURAMENTO": "Cliente entra em contato para passar auto-leitura, porem ja passou do prazo devido para informar a leitura. Procedimento nao efetuado. foi informado e orientado de acordo pois sera faturado por media."
            },
            "LIGA√á√ÉO NOVA": {
                "REALIZADO": "Cliente solicita liga√ß√£o nova ___ em seu endere√ßo com ___ de carga com data boa para dia: ___. Liga√ß√£o nova realizada de acordo, mediante a confirma√ß√£o de todos os dados necess√°rios.",
                "DEBITOS": "Cliente solicita liga√ß√£o nova de uma unidade consumidora. N√£o foi solicitado pois continha debitos.",
                "SEM DADOS": "Cliente solicita liga√ß√£o nova, por√©m, o mesmo n√£o soube informar a tens√£o do fornecimento que ser√° utilizado e nem a carga que ser√° declara. Informado e orientado para que realize a solicita√ß√£o novamente com todos os dados necess√°rios.",
                "SEM CADRASTO": "cliente solicita liga√ß√£o nova, porem n√£o tem vinculo. recomendado a utilizar os canais de acordo.",
                "NAO ERA O TITULAR": "cliente solicita liga√ß√£o nova de terceiros, porem o titular n√£o estava proximo. orientada de acordo ser o titular em linha",
                "CNPJ": "Cliente solicita liga√ß√£o nova em um cnpj, recomendado de acordo com so pessoa fisica ou caso contrario presencial."
            },
            "TROCA DE PADR√ÉO": {
                "REALIZADO": "cliente entra em contato solicitando troca de padr√£o, sondado todos os dados, realizado de acordo",
                "DEBITO EM ATRASO": "cliente deseja troca de padrao mas consta com pendencias em aberto servi√ßo n√£o realizado."
            },
            "TROCA DE TITULARIDADE": {
                "REALIZADO": "Cliente solicita troca de titularidade de uma unidade consumidora para seu nome. Foi realizado a confirma√ß√£o de todos os dados necess√°rios para o servi√ßo e foi feito efetuado a troca.",
                "NAO E O TITULAR": "Cliente solicita troca de titularidade de uma unidade consumidora para o nome de outra pessoa. N√£o foi realizado pois n√£o era o novo titular",
                "NAO TEM OSDADOS": "Cliente solicita troca de titularidade de uma unidade consumidora para seu nome. N√£o foi realizado devido porque o cliente n√£o confirmou todos os dados.",
                "CNPJ": "cliente solicita troca de titularidade cnpj para pessoa fisica, recomendado de acordo a ir na loja fisica ou canais digitais",
                "SEM CADRASTO": "Cliente solicita troca de titularidade de uma unidade consumidora para seu nome. N√£o foi realizado devido a nova titular n√£o te cadastro em seu CPF. Informado e orientado de acordo.",
                "D√âBITOS NA UNIDADE": "Cliente solicita troca de titularidade da unidade para seu nome, por√©m, havia d√©bitos na unidade e n√£o foi realizado o servi√ßo. Informado e orientado de acordo.",
                "SUSPENSA": "Cliente solicita troca de titularidade da unidade para seu nome, por√©m o imoveis consta suspensa.",
                "D√âBITOS NO CPF": "Cliente solicita troca de titularidade da unidade para seu nome, por√©m, havia d√©bitos no CPF do novo titular e n√£o foi realizado o servi√ßo. Informado e orientado de acordo.",
                "FATURAMENTO": "solicita√ß√£o de troca de titularidade, nao efetuado pos esta em faturamento",
                "DESLIGAMENTO": "cliente solicita troca de titularidade mas a unidade tem uma nota de desligamento definitivo em aberto. Orientado de acordo",
                "NOTA JA EM ANDAMENTO": "cliente solicita troca de titularidade, mas j√° consta em andamento."
            },
            "DESLIGAMENTO DEFINITIVO": {
                "REALIZADO": "Cliente solicita que seja realizado o encerramento de contrato/desligamento definitivo. Sondado todos os dados, realizado de acordo",
                "SEM TITULAR": "Cliente solicita que seja realizado o encerramento de contrato/desligamento definitivo. N√£o foi realizado pois o mesmo que estava em linha n√£o seria o titular da conta.",
                "DEBITO": "Cliente solicita que seja realizado o encerramento de contrato/desligamento definitivo. N√£o realizado pos esta em faturamento",
                "CNPJ": "Cliente solicita que seja realizado o encerramento de contrato/desligamento definitivo. N√£o realizado pos era pessoa juridica",
                "FATURAMENTO": "Cliente solicita que seja realizado o encerramento de contrato/desligamento definitivo. N√£o realizado pos esta em periodo de faturamento."
            },
            "PARCELAMENTO": {
                "REALIZADO": "Cliente solicita o parcelamento de seus d√©bitos em aberto na sua unidade com entrada de ___ com __ parcelas de __.Foi realizado a confirma√ß√£o de todos os dados necess√°rios e o mesmo seria o titular em linha.",
                "SEM TITULAR": "cliente solicita parcelar suas dividas, n√£o foi realizado pois n√£o era o titular e n√£o confirmou todos os dados.",
                "CREDITO": "cliente solicita parcelar suas dividas, porem n√£o foi realizado, pois no sistema so constatava cart√£o de credito.",
                "EXTRAVIO": "cliente nao recebeu a primeira entrada do parcelamento, dia previsto ___. repassado as informa√ß√µes pro setor responsavel para ter o seu retorno",
                "CNPJ": "cliente solicita parcelar suas dividas, porem n√£o foi realizado, pois era cnpj"
            },
            "ILUMINA√á√ÉO PUBLICA": {
                "REALIZADO": "Cliente solicita servi√ßo de ilumina√ß√£o publica, nota gerada de acordo.",
                "PREFEITURA": "Cliente solicita servi√ßo de ilumina√ß√£o publica, foi verificado no sistema que a cidade n√£o tem liminar e foi informado a cliente a entrar em contato com a prefeitura.",
                "NOTA JA EM ANDAMENTO": "Cliente solicita servi√ßo de ilumina√ß√£o publica, foi verificado no sistema que j√° existia uma solicita√ß√£o em aberto, orientado aguarda o prazo estimado."
            },
            "RESET DE SENHA": {
                "REALIZADO": "Cliente entra em contato para informar que nao esta conseguindo acessar o site, o mesmo solicita um reset de senha para que possa realizar o procedimento (script de seguranca confirmado).",
                "NAO ERA O TITULAR": "cliente deseja reset de senha, n√£o realizado pos n√£o era o titular."
            },
            "COMTESTAR VALOR DE FATURAS": {
                "FATURA ESTA CORRETA": "Cliente entra em contato para informar que suas contas estao vindo num valor mais alto que o normal para uma unidade que nao esta consumindo tanta energia. Informado a mesma que de acordo com seu historico de consumo e leitura dos ultimos 12 meses, nao ha nenhum erro por parte do leiturista e a fatura esta devida.",
                "VALOR ERRADO": "cliente entra em contato para contestar o valor da sua fatura, verificado em sistema a leitura ____ atual mostra como recorrente, porem o consumo veio abaixo do mes anterior e o valo consta muito alto. verificado os scripts, transferido com valida√ß√£o",
                "TRANSFERIDO PARA SPEC": "Cliente informa que sua fatura esta vindo com um falor alto, orientado de acordo, o mesmo n√£o aceita, transferido de acordo."
            },
            "FATURA EM DUPLICIDADE": {
                "ORIENTADO DE ACORDO": "Cliente entra em contato para informar que pagou uma fatura em duplicidade. Foi informado ao mesmo que pode aguardar que sera descontado na proxima fatura, ou ir ate uma agencia fisica para solicitar um reembolso."
            },
            "ESPEC": {
                "GERAL": "cliente entra e contato para solicitar informa√ß√µes sobre seus d√©bitos, porem a mesma informa que o consumo esta muito alto, foi verificado em sistema que a leitura atual mostra ____, e se encontra normal e recorrente, porem a mesma deseja reclamar e solicita uma vistoria. transferido de acordo e com valida√ß√£o",
                "RESSARCIMENTO DE DANOS": "Cliente deseja solicitar um ressacimento de danos, foi confirmado com o cliente a marca, o modelo, tempo de uso, se houve conserto anteriormente e a data e hor√°rio aproximado que teve a falta de energia. foi confirmado os dados pessoais e transferido para o setor respons√°vel.",
                "COBRAN√áAS": "cliente relata que esta vindo cobran√ßas para ela de faturas ja pagas, a mesma afirma que tem o comprovante em m√£os. sondado os dados transferido de acordo."
            },
            "FALTA DE COMUNICA√á√ÉO": {
                "LIGA√á√ÉO MUDA": "Cliente entra em contato sobre ____, por√©m, sua liga√ß√£o fica completamente muda. Foi realizado o retorno, por√©m, sem sucesso.",
                "BAIXO CAL√ÉO": "cliente relata____, porem comecou a falar palavras de baixo cal√£o, como de acordo, por falta de comunica√ß√£o foi encerrado o atendimento."
            }
        };

        // Global array to store history items
        let historyRecords = [];

        // Elementos do DOM
        const empresaSelect = document.getElementById('empresa');
        const nomeInput = document.getElementById('nome');
        const ucCpfInput = document.getElementById('ucCpf');
        const telefoneInput = document.getElementById('telefone');
        const motivoSelect = document.getElementById('motivo');
        const subtipoSelect = document.getElementById('subtipo');
        const derivacaoSelect = document.getElementById('derivacao');
        const subtipoDerivacaoContainer = document.getElementById('subtipoDerivacaoContainer');
        const derivacaoFormGroup = document.getElementById('derivacaoFormGroup');
        const referenciaInput = document.getElementById('referencia');
        const observacoesTextarea = document.getElementById('observacoes');
        const copyButton = document.getElementById('copyButton');
        const outputContent = document.getElementById('outputContent');
        const clearFormButton = document.getElementById('clearFormButton');

        // Novos elementos para as se√ß√µes de informa√ß√£o
        const toggleNotepadButton = document.getElementById('toggleNotepadButton');
        const notepadContent = document.getElementById('notepadContent');
        const clearNotepadButton = document.getElementById('clearNotepadButton');

        // Novos elementos para a se√ß√£o de Senhas Pessoais e Logins
        const togglePersonalPasswordsButton = document.getElementById('togglePersonalPasswordsButton');
        const personalPasswordsContent = document.getElementById('personalPasswordsContent');
        const clearPersonalPasswordsButton = document.getElementById('clearPersonalPasswordsButton');


        const toggleHistoryButton = document.getElementById('toggleHistoryButton');
        const historyContent = document.getElementById('historyContent');
        const historySearchInput = document.getElementById('historySearchInput');
        const clearHistoryButton = document.getElementById('clearHistoryButton');

        const toggleManualLookupButton = document.getElementById('toggleManualLookupButton');
        const manualLookupContent = document.getElementById('manualLookupContent');
        const manualLookupSearchInput = document.getElementById('manualLookupSearchInput');

        const toggleAdditionalInfoButton = document.getElementById('toggleAdditionalInfoButton');
        const additionalInfoContent = document.getElementById('additionalInfoContent');
        const additionalInfoSearchInput = document.getElementById('additionalInfoSearchInput');
        
        const toggleColorCustomizationButton = document.getElementById('toggleColorCustomizationButton');
        const colorCustomizationContent = document.getElementById('colorCustomizationContent');


        const copyFeedback = document.getElementById('copyFeedback');

        // Custom Modal elements
        const customAlertModal = document.getElementById('customAlertModal');
        const customAlertMessage = document.getElementById('customAlertMessage');
        const customConfirmModal = document.getElementById('customConfirmModal');
        const customConfirmMessage = document.getElementById('customConfirmMessage');
        const confirmYesButton = document.getElementById('confirmYesButton');
        const confirmNoButton = document.getElementById('confirmNoButton');
        let confirmCallback = null;

        // Bot√£o de alternar modo removido, ent√£o a constante modeToggleButton e seus listeners s√£o removidos.
        // Conte√∫do original da se√ß√£o de Informa√ß√µes Adicionais (para filtro)
        let originalAdditionalInfoContentHTML = ''; 

        // Color Customization Elements
        const customColorPickers = {
            '--main-bg-color': document.getElementById('bgColorPicker'),
            '--container-bg-color': document.getElementById('containerBgColorPicker'),
            '--main-text-color': document.getElementById('textColorPicker'),
            '--label-color': document.getElementById('labelColorPicker'),
            '--input-bg-color': document.getElementById('inputBgColorPicker'),
            '--input-border-color': document.getElementById('inputTextBorderColorPicker'),
            '--input-text-color': document.getElementById('inputTextColorPicker'),
            '--copy-button-bg': document.getElementById('copyBtnBgColorPicker'),
            '--copy-button-text': document.getElementById('copyBtnTextColorPicker'),
            '--clear-button-bg': document.getElementById('clearBtnBgColorPicker'),
            '--clear-button-text': document.getElementById('clearBtnTextColorPicker'),
            '--output-bg-color': document.getElementById('outputBgColorPicker'),
            '--output-text-color': document.getElementById('outputTextColorPicker'),
            '--output-border-color': document.getElementById('outputBorderColorPicker')
        };
        const resetColorsButton = document.getElementById('resetColorsButton');
        const randomColorsButton = document.getElementById('randomColorsButton'); // Added random color button

        // Elements for hiding/showing theme related controls
        const themePresetsContainer = document.getElementById('themePresets');
        const colorPickersContainer = document.getElementById('colorPickers');

        // Transparency Slider Elements
        const transparencySlider = document.getElementById('transparencySlider');
        const transparencyValue = document.getElementById('transparencyValue');


        // Preset Themes
        const presetThemes = {
            'default-dark': {
                '--main-bg-color': '#000000',
                '--container-bg-color': '#000000',
                '--main-text-color': '#FFFFFF',
                '--label-color': '#EEEEEE',
                '--input-bg-color': '#444444',
                '--input-border-color': '#555555',
                '--input-text-color': '#FFFFFF',
                '--copy-button-bg': '#4CAF50',
                '--copy-button-text': '#FFFFFF',
                '--clear-button-bg': '#e0e0e0',
                '--clear-button-text': '#000000',
                '--output-bg-color': '#222222',
                '--output-text-color': '#FFFFFF',
                '--output-border-color': '#555555',
                'isLightMode': false
            },
            'default-light': {
                '--main-bg-color': '#f0f0f0',
                '--container-bg-color': '#FFFFFF', /* This will be overridden by the general dark-form rule */
                '--main-text-color': '#333333',
                '--label-color': '#555555',
                '--input-bg-color': '#f8f8f8', /* This will be overridden by the general dark-form rule */
                '--input-border-color': '#cccccc', /* This will be overridden by the general dark-form rule */
                '--input-text-color': '#333333', /* This will be overridden by the general dark-form rule */
                '--copy-button-bg': '#4CAF50',
                '--copy-button-text': '#FFFFFF',
                '--clear-button-bg': '#cccccc',
                '--clear-button-text': '#333333',
                '--output-bg-color': '#f9f9f9', /* This will be overridden by the general dark-form rule */
                '--output-text-color': '#333333', /* This will be overridden by the general dark-form rule */
                '--output-border-color': '#dddddd', /* This will be overridden by the general dark-form rule */
                'isLightMode': true
            },
            'azul-oceano': {
                '--main-bg-color': '#0A192F',
                '--container-bg-color': '#172A45',
                '--main-text-color': '#E6F1FF',
                '--label-color': '#69B3FF',
                '--input-bg-color': '#0D274E',
                '--input-border-color': '#365D8F',
                '--input-text-color': '#D3E7FF',
                '--copy-button-bg': '#00BFFF',
                '--copy-button-text': '#FFFFFF',
                '--clear-button-bg': '#87CEFA',
                '--clear-button-text': '#000000',
                '--output-bg-color': '#0F2038',
                '--output-text-color': '#E6F1FF',
                '--output-border-color': '#365D8F',
                'isLightMode': false
            },
            'azul-eletrico': {
                '--main-bg-color': '#1A1A2E',
                '--container-bg-color': '#2A094E',
                '--main-text-color': '#E0FFFF',
                '--label-color': '#00FFFF',
                '--input-bg-color': '#0F3460',
                '--input-border-color': '#007BFF',
                '--input-text-color': '#E0FFFF',
                '--copy-button-bg': '#00BFFF',
                '--copy-button-text': '#FFFFFF',
                '--clear-button-bg': '#87CEEB',
                '--clear-button-text': '#001F3F',
                '--output-bg-color': '#162447',
                '--output-text-color': '#E0FFFF',
                '--output-border-color': '#007BFF',
                'isLightMode': false
            },
            'noite-estrelada': {
                '--main-bg-color': '#000033',
                '--container-bg-color': '#0A0A5C',
                '--main-text-color': '#E6E6FA', /* Lavender */
                '--label-color': '#CCCCFF', /* Light Steel Blue */
                '--input-bg-color': '#191970', /* Midnight Blue */
                '--input-border-color': '#4169E1', /* Royal Blue */
                '--input-text-color': '#E6E6FA',
                '--copy-button-bg': '#FFD700', /* Gold */
                '--copy-button-text': '#000033',
                '--clear-button-bg': '#ADD8E6', /* Light Blue */
                '--clear-button-text': '#000033',
                '--output-bg-color': '#0F0F80',
                '--output-text-color': '#E6E6FA',
                '--output-border-color': '#4169E1',
                'isLightMode': false
            }
        };

        // New DOM elements for background image
        const backgroundImageInput = document.getElementById('backgroundImageInput');
        const clearBackgroundImageButton = document.getElementById('clearBackgroundImageButton');


        // Function to show custom alert modal
        function showCustomAlert(message) {
            customAlertMessage.textContent = message;
            customAlertModal.style.display = 'flex';
        }

        // Function to hide custom alert modal
        function hideCustomAlert() {
            customAlertModal.style.display = 'none';
        }

        // Function to show custom confirmation modal
        function showCustomConfirm(message, callback) {
            customConfirmMessage.textContent = message;
            confirmCallback = callback;
            customConfirmModal.style.display = 'flex';
        }

        // Functions to handle confirmation/cancellation of the modal
        confirmYesButton.onclick = () => {
            if (confirmCallback) {
                confirmCallback(true);
            }
            customConfirmModal.style.display = 'none';
        };

        confirmNoButton.onclick = () => {
            if (confirmCallback) {
                confirmCallback(false);
            }
            customConfirmModal.style.display = 'none';
        };

        // Fun√ß√µes para popular os selects
        function populateMotivos() {
            motivoSelect.innerHTML = '<option value="">Selecione o motivo</option>';
            for (const motivoKey in motivosData) {
                const option = document.createElement('option');
                option.value = motivoKey;
                option.textContent = motivoKey;
                motivoSelect.appendChild(option);
            }
            populateSubtipos(''); 
            generateOutput();
        }

        function populateSubtipos(motivo) {
            subtipoSelect.innerHTML = '<option value="">Selecione o subtipo</option>';
            derivacaoSelect.innerHTML = '<option value="">Selecione a deriva√ß√£o</option>';
            subtipoDerivacaoContainer.style.display = 'none';
            derivacaoFormGroup.style.display = 'none';

            if (motivo && motivosData[motivo]) {
                const subtipos = motivosData[motivo];

                if (typeof subtipos === 'object' && subtipos !== null && !Array.isArray(subtipos)) {
                    const subtipoKeys = Object.keys(subtipos);
                    
                    if (subtipoKeys.length > 0) {
                        subtipoDerivacaoContainer.style.display = 'block';

                        for (const subKey of subtipoKeys) {
                            const option = document.createElement('option');
                            option.value = subKey;
                            option.textContent = subKey;
                            subtipoSelect.appendChild(option);
                        }

                        if (subtipoKeys.length === 1 && typeof subtipos[subtipoKeys[0]] === 'object') {
                            subtipoSelect.value = subtipoKeys[0];
                            populateDerivacoes(motivo, subtipoKeys[0]);
                        } else {
                            populateDerivacoes(motivo, subtipoSelect.value);
                        }
                    }
                }
            }
            // generateOutput(); // Removed redundant call from here
        }

        function populateDerivacoes(motivo, subtipo) {
            derivacaoSelect.innerHTML = '<option value="">Selecione a deriva√ß√£o</option>';
            derivacaoFormGroup.style.display = 'none';

            if (motivo && subtipo && motivosData[motivo] && motivosData[motivo][subtipo]) {
                const derivacoes = motivosData[motivo][subtipo]; // Corrected typo: motivosData[motipo] to motivosData[motivo]

                if (typeof derivacoes === 'object' && derivacoes !== null && !Array.isArray(derivacoes)) {
                    const derivacaoKeys = Object.keys(derivacoes);
                    if (derivacaoKeys.length > 0) {
                        derivacaoFormGroup.style.display = 'block';
                        for (const derKey of derivacaoKeys) {
                            const option = document.createElement('option');
                            option.value = derKey;
                            option.textContent = derKey;
                            derivacaoSelect.appendChild(option);
                        }

                        if (derivacaoKeys.length === 1) {
                            derivacaoSelect.value = derivacaoKeys[0];
                        }
                    }
                }
            }
            // generateOutput(); // Removed redundant call from here
        }

        // Fun√ß√£o para formatar UC/CPF - removes non-numeric characters
        function formatUcOrCpf(value) {
            return value.replace(/\D/g, '');
        }

        // Fun√ß√£o para gerar o conte√∫do formatado
        function generateOutput() {
            console.log("generateOutput called!"); // Added for debugging
            const empresa = empresaSelect.value;
            const nome = nomeInput.value.toUpperCase();
            const ucCpf = ucCpfInput.value; 
            const telefone = telefoneInput.value;
            const motivo = motivoSelect.value;
            const subtipo = subtipoSelect.value;
            const derivacao = derivacaoSelect.value;
            const observacoes = observacoesTextarea.value;

            let output = `EMPRESA: ${empresa}\n`;
            output += `NOME: ${nome}\n`;
            output += `UC/CPF: ${ucCpf}\n`;
            output += `TELEFONE: ${telefone}\n`;
            
            let motivoDescription = '';
            if (motivo && motivosData[motivo]) {
                const currentMotivoData = motivosData[motivo];

                if (typeof currentMotivoData === 'string') {
                    motivoDescription = currentMotivoData;
                } else {
                    if (subtipo && currentMotivoData[subtipo]) {
                        const currentSubtipoData = currentMotivoData[subtipo];

                        if (typeof currentSubtipoData === 'string') {
                            motivoDescription = currentSubtipoData;
                        } else {
                            if (derivacao && currentSubtipoData[derivacao]) {
                                motivoDescription = currentSubtipoData[derivacao];
                            } else {
                                motivoDescription = `Selecione uma deriva√ß√£o para "${subtipo}".`;
                            }
                        }
                    } else if (Object.keys(currentMotivoData).length > 0) {
                        motivoDescription = `Selecione um subtipo para "${motivo}".`;
                    } else {
                         motivoDescription = `Detalhe do motivo "${motivo}" n√£o encontrado ou incompleto.`;
                    }
                }
            } else {
                motivoDescription = "Motivo n√£o selecionado.";
            }

            output += `MOTIVO: ${motivoDescription}\n`;
            output += `REFERENCIA: ${referenciaInput.value}\n`;
            output += `PROTOCOLO: ${observacoes}\n`;

            outputContent.value = output;
        }

        // Saves history to localStorage
        function saveHistory() {
            localStorage.setItem('callHistory', JSON.stringify(historyRecords));
        }

        // Loads history from localStorage
        function loadHistory() {
            const savedHistory = localStorage.getItem('callHistory');
            if (savedHistory) {
                historyRecords = JSON.parse(savedHistory);
                renderHistory(); // Render history on load
            }
        }

        // Function to add to history
        function addToHistory(item) {
            const now = new Date();
            const timestamp = `${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;
            const record = {
                content: item,
                timestamp: timestamp
            };
            historyRecords.unshift(record); // Add to the beginning to show newest first
            saveHistory(); // Save after adding
            renderHistory(); // Re-render the history
        }

        // Function to render or re-render the history section
        function renderHistory(filteredRecords = null) {
            historyContent.innerHTML = ''; // Clear existing content
            const recordsToDisplay = filteredRecords || historyRecords;

            if (recordsToDisplay.length === 0) {
                historyContent.innerHTML = '<p style="text-align: center; color: var(--label-color);">Nenhum registro no hist√≥rico.</p>';
                return;
            }

            recordsToDisplay.forEach((record, index) => {
                const historyItemDiv = document.createElement('div');
                historyItemDiv.classList.add('history-item');
                
                // Get the original index to allow correct deletion from historyRecords array
                // Find the index of the current record in the main historyRecords array
                const originalIndex = historyRecords.indexOf(record);
                
                // Numbering will be based on the displayed order (newest first as #1)
                const recordNumber = index + 1; // For display order

                historyItemDiv.innerHTML = `
                    <div class="history-item-content">
                        <strong>#${recordNumber}</strong><br>
                        <small>(${record.timestamp})</small><br>${record.content}
                    </div>
                    <div class="history-item-actions">
                        <button class="history-item-copy-button">Copiar</button>
                        <button class="history-item-delete-button" data-original-index="${originalIndex}">Apagar</button>
                    </div>
                `;
                historyContent.appendChild(historyItemDiv);

                // Add event listeners for copy and delete buttons
                historyItemDiv.querySelector('.history-item-copy-button').addEventListener('click', () => {
                    const textToCopy = record.content;
                    copyToClipboard(textToCopy);
                });

                historyItemDiv.querySelector('.history-item-delete-button').addEventListener('click', (event) => {
                    const indexToDelete = parseInt(event.target.dataset.originalIndex);
                    deleteHistoryItem(indexToDelete);
                });
            });
        }

        // Function to delete a specific history item
        function deleteHistoryItem(originalIndex) {
            // No confirmation modal, delete directly
            historyRecords.splice(originalIndex, 1); // Remove item from array
            saveHistory(); // Save after deleting
            filterHistory(); // Re-render the history (and apply current filter if any)
        }

        // Function to copy to clipboard
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);

            copyFeedback.style.opacity = 1;
            setTimeout(() => {
                copyFeedback.style.opacity = 0;
            }, 1500);
        }

        // Function to filter additional info content
        function filterAdditionalInfo() {
            const searchTerm = additionalInfoSearchInput.value.toLowerCase();
            const parser = new DOMParser();
            const doc = parser.parseFromString(originalAdditionalInfoContentHTML, 'text/html');
            const elements = doc.querySelectorAll('h2, h3, p, ul, ol, li, hr'); // Include hr to keep separators

            const tempDiv = document.createElement('div');
            
            let anyMatch = false;
            Array.from(elements).forEach(child => {
                let shouldDisplay = false;
                if (child.tagName === 'HR' && child.classList.contains('double-line')) {
                    shouldDisplay = true; // Always show double-line HRs
                } else if (child.textContent.toLowerCase().includes(searchTerm)) {
                    shouldDisplay = true;
                }

                if (shouldDisplay) {
                    tempDiv.appendChild(child.cloneNode(true)); // Clone to avoid moving nodes
                    anyMatch = true;
                }
            });

            if (!anyMatch && searchTerm !== '') {
                additionalInfoContent.innerHTML = '<p>Nenhum resultado encontrado.</p>';
            } else {
                additionalInfoContent.innerHTML = tempDiv.innerHTML;
            }
        }


        // Fun√ß√£o para gerar o conte√∫do do guia de motivos
        function generateManualLookupContent() {
            let content = '';
            for (const motivoKey in motivosData) {
                content += `<h3>${motivoKey}</h3>`;
                const subtipos = motivosData[motivoKey];
                if (typeof subtipos === 'string') {
                    content += `<p>- ${subtipos}</p>`;
                } else {
                    for (const subtipoKey in subtipos) {
                        const derivacoes = subtipos[subtipoKey];
                        if (typeof derivacoes === 'string') {
                            content += `<p>- ${subtipoKey}: ${derivacoes}</p>`;
                        } else {
                            content += `<p>- ${subtipoKey}:</p><ul>`;
                            for (const derivacaoKey in derivacoes) {
                                content += `<li>${derivacaoKey}: ${derivacoes[derivacaoKey]}</li>`;
                            }
                            content += `</ul>`;
                        }
                    }
                }
                content += `<hr>`;
            }
            manualLookupContent.innerHTML = content;
        }

        // Fun√ß√£o para filtrar o guia de motivos
        function filterManualLookup() {
            const searchTerm = manualLookupSearchInput.value.toLowerCase();
            let filteredContent = '';

            for (const motivoKey in motivosData) {
                let motivoMatches = false;
                if (motivoKey.toLowerCase().includes(searchTerm)) {
                    motivoMatches = true;
                }

                const subtipos = motivosData[motivoKey];

                if (typeof subtipos === 'string') {
                    if (subtipos.toLowerCase().includes(searchTerm) || motivoMatches) {
                        filteredContent += `<h3>${motivoKey}</h3><p>- ${subtipos}</p><hr>`;
                    }
                } else {
                    let subtipoContent = '';
                    let hasSubtipoOrDerivacaoMatch = false;

                    for (const subtipoKey in subtipos) {
                        let currentSubtipoHtml = '';
                        const derivacoes = subtipos[subtipoKey];

                        if (typeof derivacoes === 'string') {
                            if (subtipoKey.toLowerCase().includes(searchTerm) || derivacoes.toLowerCase().includes(searchTerm)) {
                                currentSubtipoHtml += `<p>- ${subtipoKey}: ${derivacoes}</p>`;
                                hasSubtipoOrDerivacaoMatch = true;
                            }
                        } else {
                            let derivacaoListHtml = '';
                            for (const derivacaoKey in derivacoes) {
                                if (derivacaoKey.toLowerCase().includes(searchTerm) || derivacoes[derivacaoKey].toLowerCase().includes(searchTerm)) {
                                    derivacaoListHtml += `<li>${derivacaoKey}: ${derivacoes[derivacaoKey]}</li>`;
                                    hasSubtipoOrDerivacaoMatch = true;
                                }
                            }
                            if (derivacaoListHtml) {
                                currentSubtipoHtml += `<p>- ${subtipoKey}:</p><ul>${derivacaoListHtml}</ul>`;
                                hasSubtipoOrDerivacaoMatch = true;
                            }
                        }
                        subtipoContent += currentSubtipoHtml;
                    }

                    if (motivoMatches || hasSubtipoOrDerivacaoMatch) {
                        filteredContent += `<h3>${motivoKey}</h3>`;
                        filteredContent += subtipoContent;
                        filteredContent += `<hr>`;
                    }
                }
            }
            manualLookupContent.innerHTML = filteredContent || '<p>Nenhum resultado encontrado.</p>';
        }

        // Function to filter history records based on search input
        function filterHistory() {
            const searchTerm = historySearchInput.value.toLowerCase();
            if (searchTerm === '') {
                renderHistory(); // If search box is empty, render all records
                return;
            }
            const filtered = historyRecords.filter(record => 
                record.content.toLowerCase().includes(searchTerm) ||
                record.timestamp.toLowerCase().includes(searchTerm)
            );
            renderHistory(filtered); // Render only the filtered records
        }


        // Fun√ß√£o para alternar entre os modos claro e escuro (AGORA S√ì VIA PRESETS OU MANIPULA√á√ÉO DIRETA)
        function toggleTheme() {
            // Esta fun√ß√£o n√£o ser√° mais chamada pelo bot√£o removido.
            // A l√≥gica de tema agora √© gerenciada por applyPresetTheme.
            console.warn("toggleTheme() called, but the button has been removed. Theme changes are now handled by presets or image background.");
        }

        // Function to apply colors to CSS variables based on values in the color pickers
        function applyColorsFromPickers() {
            const root = document.documentElement; // Refers to <html>
            for (const prop in customColorPickers) {
                root.style.setProperty(prop, customColorPickers[prop].value);
            }
        }

        // Function to save current custom colors from picker values to localStorage
        function saveCustomColors() {
            const currentColors = {};
            for (const prop in customColorPickers) {
                currentColors[prop] = customColorPickers[prop].value; // Get value directly from picker
            }
            localStorage.setItem('customColors', JSON.stringify(currentColors));
            localStorage.removeItem('selectedPresetTheme'); // Clear any selected preset when customizing
            clearPresetThemeSelection(); // Ensure no preset button is active
        }

        // Function to load custom colors from localStorage and apply them
        function loadCustomColors() {
            const savedColors = localStorage.getItem('customColors');
            if (savedColors) {
                const colors = JSON.parse(savedColors);
                // Update the color pickers with loaded values first
                for (const prop in colors) {
                    if (customColorPickers[prop]) {
                        customColorPickers[prop].value = colors[prop];
                    }
                }
                applyColorsFromPickers(); // Apply colors to CSS variables based on updated pickers
                return true; // Indicates custom colors were loaded
            }
            return false; // Indicates no custom colors were loaded
        }

        // Function to reset custom colors to theme defaults
        function resetCustomColors() {
            localStorage.removeItem('customColors'); // Clear saved custom colors
            localStorage.removeItem('selectedPresetTheme'); // Clear saved preset theme
            
            // Revert body class to its default state or based on previously saved 'theme'
            // The 'theme' localStorage item is no longer used by the removed button, but can still
            // influence the 'light-mode' class if a preset or image was active.
            const savedThemePreference = localStorage.getItem('theme'); // This might be 'light' or 'dark' from presets
            if (savedThemePreference === 'light') {
                document.body.classList.add('light-mode');
            } else {
                document.body.classList.remove('light-mode');
            }

            // Update color pickers to reflect the current theme's defaults
            updateColorPickersToCurrentTheme();
            // Apply these defaults from pickers to ensure CSS variables are set
            applyColorsFromPickers();
            clearPresetThemeSelection(); // Ensure no preset button is active
        }

        // Function to update color pickers to reflect the current theme's computed styles
        function updateColorPickersToCurrentTheme() {
            const root = document.documentElement;
            // Iterate through each custom property and set the picker value to its computed style
            for (const prop in customColorPickers) {
                const computedColor = getComputedStyle(root).getPropertyValue(prop).trim();
                customColorPickers[prop].value = computedColor;
            }
        }

        // Apply preset theme function
        function applyPresetTheme(themeName) {
            // Do NOT call applyBackgroundImage(null) here directly.
            // If the user selects a preset while an image is active, the image will just cover it.
            // When the image is cleared, loadInitialThemeAndColors will pick up the last theme/colors.
            
            const themeColors = presetThemes[themeName];
            if (themeColors) {
                 // Set light/dark mode based on the preset's property
                if (themeColors.isLightMode) {
                    document.body.classList.add('light-mode');
                    localStorage.setItem('theme', 'light');
                } else {
                    document.body.classList.remove('light-mode');
                    localStorage.setItem('theme', 'dark');
                }

                // Apply the colors from the preset to the CSS variables
                for (const prop in themeColors) {
                    // Only apply if the property is a color picker (skip `isLightMode`)
                    if (customColorPickers[prop]) {
                        customColorPickers[prop].value = themeColors[prop]; 
                    }
                }
                applyColorsFromPickers(); // Apply colors to CSS variables based on updated pickers

                localStorage.setItem('selectedPresetTheme', themeName); // Save selected preset
                localStorage.removeItem('customColors'); // Clear custom colors if a preset is selected
                
                updateActivePresetButton(themeName);
            }
        }

        // Function to generate a random hex color
        function getRandomColor() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        // Function to apply random colors
        function applyRandomColors() {
            // Do NOT call applyBackgroundImage(null) here directly.
            // If the user selects random colors while an image is active, the image will just cover it.
            // When the image is cleared, loadInitialThemeAndColors will pick up the last theme/colors.
            
            const randomColors = {};
            for (const prop in customColorPickers) {
                randomColors[prop] = getRandomColor();
            }
            // Update color pickers with the newly generated random colors
            for (const prop in randomColors) {
                if (customColorPickers[prop]) {
                    customColorPickers[prop].value = randomColors[prop];
                }
            }
            applyColorsFromPickers(); // Apply colors to CSS variables based on updated pickers
            localStorage.removeItem('selectedPresetTheme'); // Clear preset theme when random is applied
            localStorage.setItem('customColors', JSON.stringify(randomColors)); // Save the random colors as custom
            clearPresetThemeSelection(); // Ensure no preset button is active
            // The theme (light/dark) should not change with random colors, keep the current one.
        }

        // Function to update active preset button visual
        function updateActivePresetButton(activeThemeName) {
            document.querySelectorAll('.theme-select-button').forEach(button => {
                if (button.dataset.theme === activeThemeName) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });
        }

        // Function to clear active preset button visual
        function clearPresetThemeSelection() {
            document.querySelectorAll('.theme-select-button').forEach(button => {
                button.classList.remove('active');
            });
        }

        // Function to apply background image
        function applyBackgroundImage(imageDataUrl) {
            if (imageDataUrl) {
                document.body.style.backgroundImage = `url('${imageDataUrl}')`;
                document.body.style.backgroundSize = 'cover';
                document.body.style.backgroundPosition = 'center';
                document.body.style.backgroundAttachment = 'fixed';
                document.body.style.backgroundRepeat = 'no-repeat';
                localStorage.setItem('backgroundImage', imageDataUrl);
                
                // Hide theme controls and add class to body for input border hiding
                // modeToggleButton.style.display = 'none'; // Removed as button is gone
                themePresetsContainer.style.display = 'none';
                colorPickersContainer.style.display = 'none';
                document.body.classList.add('has-background-image'); 

                // Visually reset the background color picker when image is active
                // This doesn't affect the actual background, just the picker's display
                // Note: The actual main background color is overridden by the image,
                // but setting the picker helps in visual consistency if the image is removed later.
                customColorPickers['--main-bg-color'].value = '#000000'; 
                applyColorsFromPickers(); // Apply to sync CSS vars (though image overrides main-bg-color)
            } else {
                document.body.style.backgroundImage = 'none';
                document.body.style.backgroundSize = '';
                document.body.style.backgroundPosition = '';
                document.body.style.backgroundAttachment = '';
                document.body.style.backgroundRepeat = '';
                localStorage.removeItem('backgroundImage');

                // Show theme controls and remove class from body
                // modeToggleButton.style.display = 'block'; // Removed as button is gone
                themePresetsContainer.style.display = 'block';
                colorPickersContainer.style.display = 'block';
                document.body.classList.remove('has-background-image'); 
                
                // After clearing, re-evaluate and apply the theme/colors that should be active
                loadInitialThemeAndColors();
            }
        }

        // Centralized function to load theme and colors on startup or after clearing image
        function loadInitialThemeAndColors() {
            const savedBackgroundImage = localStorage.getItem('backgroundImage'); // Check if there's a saved image
            if (savedBackgroundImage) {
                applyBackgroundImage(savedBackgroundImage); // Apply the image and skip color loading for now
                loadInitialTransparency(); // Load transparency even with image
                return; // Exit function, as image takes precedence for initial load
            }

            // The 'theme' localStorage item is now primarily managed by preset theme selection
            // The light/dark mode will be set by the applied preset or custom colors
            // There's no longer a direct "toggle" button for it outside the customization section
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') { // Check if a preset theme previously set a 'light' mode
                document.body.classList.add('light-mode');
            } else {
                document.body.classList.remove('light-mode');
            }


            const selectedPresetTheme = localStorage.getItem('selectedPresetTheme');
            const customColorsLoaded = loadCustomColors(); // Try to load custom colors

            if (selectedPresetTheme) {
                // If a preset theme was saved, apply it (this will also set the light/dark mode and update pickers)
                const themeToApply = presetThemes[selectedPresetTheme];
                if (themeToApply) { // Double check if theme exists
                    if (themeToApply.isLightMode) {
                        document.body.classList.add('light-mode');
                        localStorage.setItem('theme', 'light');
                    } else {
                        document.body.classList.remove('light-mode');
                        localStorage.setItem('theme', 'dark');
                    }

                    for (const prop in themeToApply) {
                        if (customColorPickers[prop]) {
                            customColorPickers[prop].value = themeToApply[prop]; 
                        }
                    }
                    applyColorsFromPickers();
                    updateActivePresetButton(selectedPresetTheme);
                }
            } else if (customColorsLoaded) {
                // If custom colors were loaded, the loadCustomColors function already updated pickers and applied them.
                clearPresetThemeSelection(); // Ensure no preset button is active if custom colors are loaded
            } else {
                // If neither preset nor custom colors, fall back to default computed styles
                updateColorPickersToCurrentTheme();
                applyColorsFromPickers(); 
                clearPresetThemeSelection(); // Ensure no preset button is active
            }
            loadInitialTransparency(); // Load transparency after theme/custom colors
        }

        // Function to load and apply initial transparency setting
        function loadInitialTransparency() {
            const savedFieldBgAlpha = localStorage.getItem('fieldBgAlpha');
            const initialAlpha = savedFieldBgAlpha !== null ? parseFloat(savedFieldBgAlpha) : 0.7; // Default to 0.7 if not saved

            transparencySlider.value = initialAlpha;
            transparencyValue.textContent = `${Math.round(initialAlpha * 100)}%`;
            document.documentElement.style.setProperty('--field-bg-alpha', initialAlpha);
        }


        // Event Listeners for form elements
        empresaSelect.addEventListener('change', generateOutput);
        nomeInput.addEventListener('input', generateOutput);
        ucCpfInput.addEventListener('input', () => {
            ucCpfInput.value = formatUcOrCpf(ucCpfInput.value); 
            generateOutput();
        });
        telefoneInput.addEventListener('input', generateOutput);

        motivoSelect.addEventListener('change', () => {
            populateSubtipos(motivoSelect.value);
            generateOutput(); // Explicitly call after populating subtipos
        });
        subtipoSelect.addEventListener('change', () => {
            populateDerivacoes(motivoSelect.value, subtipoSelect.value);
            generateOutput(); // Explicitly call after populating derivacoes
        });
        derivacaoSelect.addEventListener('change', generateOutput);
        referenciaInput.addEventListener('input', generateOutput);
        observacoesTextarea.addEventListener('input', generateOutput);

        copyButton.addEventListener('click', () => {
            if (outputContent.value.trim() === '') {
                showCustomAlert('N√£o h√° conte√∫do para copiar. Por favor, preencha os campos.');
                return;
            }
            copyToClipboard(outputContent.value);
            addToHistory(outputContent.value);
        });

        clearFormButton.addEventListener('click', () => {
            showCustomConfirm('Tem certeza que deseja limpar todos os campos do formul√°rio?', (result) => {
                if (result) {
                    empresaSelect.value = '';
                    nomeInput.value = '';
                    ucCpfInput.value = '';
                    telefoneInput.value = '';
                    motivoSelect.value = '';
                    subtipoSelect.innerHTML = '<option value="">Selecione o subtipo</option>';
                    derivacaoSelect.innerHTML = '<option value="">Selecione a deriva√ß√£o</option>';
                    subtipoDerivacaoContainer.style.display = 'none';
                    derivacaoFormGroup.style.display = 'none';
                    referenciaInput.value = '';
                    observacoesTextarea.value = '';
                    outputContent.value = '';
                    populateMotivos();
                }
            });
        });

        // Toggle buttons for sections
        toggleNotepadButton.addEventListener('click', () => {
            notepadContent.style.display = notepadContent.style.display === 'none' ? 'block' : 'none';
            // Save the state of the notepad section
            localStorage.setItem('notepadVisible', notepadContent.style.display === 'block');
        });

        // Toggle for personal passwords section
        togglePersonalPasswordsButton.addEventListener('click', () => {
            personalPasswordsContent.style.display = personalPasswordsContent.style.display === 'none' ? 'block' : 'none';
            // Save the state of the personal passwords section
            localStorage.setItem('personalPasswordsVisible', personalPasswordsContent.style.display === 'block');
        });

        toggleHistoryButton.addEventListener('click', () => {
            historyContent.style.display = historyContent.style.display === 'none' ? 'block' : 'none';
            // Save the state of the history section
            localStorage.setItem('historyVisible', historyContent.style.display === 'block');
        });

        toggleManualLookupButton.addEventListener('click', () => {
            manualLookupContent.style.display = manualLookupContent.style.display === 'none' ? 'block' : 'none';
            // Save the state of the manual lookup section
            localStorage.setItem('manualLookupVisible', manualLookupContent.style.display === 'block');
        });

        toggleAdditionalInfoButton.addEventListener('click', () => {
            additionalInfoContent.style.display = additionalInfoContent.style.display === 'none' ? 'block' : 'none';
            // Save the state of the additional info section
            localStorage.setItem('additionalInfoVisible', additionalInfoContent.style.display === 'block');
        });

        toggleColorCustomizationButton.addEventListener('click', () => {
            colorCustomizationContent.style.display = colorCustomizationContent.style.display === 'none' ? 'block' : 'none';
            // When showing, ensure pickers reflect current theme/custom colors
            if (colorCustomizationContent.style.display === 'block') {
                updateColorPickersToCurrentTheme(); // Always update pickers to current active colors
                const selectedPresetTheme = localStorage.getItem('selectedPresetTheme');
                if (selectedPresetTheme) {
                    updateActivePresetButton(selectedPresetTheme);
                } else {
                    clearPresetThemeSelection(); // If no preset is active, clear active button visual
                }
            }
            // Save the state of the color customization section
            localStorage.setItem('colorCustomizationVisible', colorCustomizationContent.style.display === 'block');
        });


        // Clear buttons for sections
        clearNotepadButton.addEventListener('click', () => {
            showCustomConfirm('Tem certeza que deseja limpar o Bloco de Notas?', (result) => {
                if (result) {
                    notepadContent.value = '';
                    localStorage.removeItem('notepadContent'); // Clear saved notepad content
                }
            });
        });

        // Clear button for personal passwords section
        clearPersonalPasswordsButton.addEventListener('click', () => {
            showCustomConfirm('Tem certeza que deseja limpar as senhas pessoais e logins?', (result) => {
                if (result) {
                    personalPasswordsContent.value = '';
                    localStorage.removeItem('personalPasswordsContent'); // Clear saved personal passwords content
                }
            });
        });

        clearHistoryButton.addEventListener('click', () => {
            showCustomConfirm('Tem certeza que deseja limpar todo o hist√≥rico de registros?', (result) => {
                if (result) {
                    historyRecords = []; // Clear the array
                    saveHistory(); // Save the empty array
                    renderHistory(); // Re-render
                }
            });
        });

        // Search inputs
        historySearchInput.addEventListener('input', filterHistory);

        manualLookupSearchInput.addEventListener('input', filterManualLookup);
        additionalInfoSearchInput.addEventListener('input', filterAdditionalInfo);

        // Event listener for color pickers - NOW calls saveCustomColors and then applyCurrentPickerColors
        for (const prop in customColorPickers) {
            customColorPickers[prop].addEventListener('input', () => {
                saveCustomColors(); // Save the current state of all pickers to localStorage
                applyColorsFromPickers(); // Apply all current picker values to ensure consistency
            });
        }
        
        resetColorsButton.addEventListener('click', () => {
            showCustomConfirm('Tem certeza que deseja restaurar as cores padr√£o do tema atual?', (result) => {
                if (result) {
                    resetCustomColors();
                }
            });
        });

        randomColorsButton.addEventListener('click', () => {
            applyRandomColors();
        });

        // Event listener para o bot√£o de alternar modo removido

        // Event listeners for preset theme buttons
        document.querySelectorAll('.theme-select-button').forEach(button => {
            button.addEventListener('click', (event) => {
                const themeName = event.target.dataset.theme;
                applyPresetTheme(themeName);
            });
        });

        // Event listener for transparency slider
        transparencySlider.addEventListener('input', (event) => {
            const alpha = parseFloat(event.target.value);
            transparencyValue.textContent = `${Math.round(alpha * 100)}%`;
            document.documentElement.style.setProperty('--field-bg-alpha', alpha);
            localStorage.setItem('fieldBgAlpha', alpha); // Save transparency
        });

        // Handler for image file selection
        backgroundImageInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                if (file.size > 5 * 1024 * 1024) { // Check if file size is greater than 5MB
                    showCustomAlert('Aten√ß√£o: A imagem selecionada √© muito grande (maior que 5MB) e pode causar lentid√£o ou problemas de salvamento. Por favor, escolha uma imagem menor.');
                    // Clear the file input so the user can select another
                    backgroundImageInput.value = ''; 
                    return; // Stop execution if file is too large
                }

                const reader = new FileReader();
                reader.onloadend = () => {
                    applyBackgroundImage(reader.result);
                };
                reader.readAsDataURL(file);
            } else {
                applyBackgroundImage(null); // Clear image if no file selected
            }
        });

        // Handler for clear background image button
        clearBackgroundImageButton.addEventListener('click', () => {
            showCustomConfirm('Tem certeza que deseja remover a imagem de fundo?', (result) => {
                if (result) {
                    applyBackgroundImage(null); // Clear the background image
                    // Clear the file input element's value
                    backgroundImageInput.value = '';
                }
            });
        });

        // Function to load saved content for notepad and personal passwords
        function loadSavedContent() {
            const savedNotepadContent = localStorage.getItem('notepadContent');
            if (savedNotepadContent) {
                notepadContent.value = savedNotepadContent;
            }
            const savedPersonalPasswordsContent = localStorage.getItem('personalPasswordsContent');
            if (savedPersonalPasswordsContent) {
                personalPasswordsContent.value = savedPersonalPasswordsContent;
            }
        }

        // Function to save content for notepad and personal passwords
        function saveContent() {
            localStorage.setItem('notepadContent', notepadContent.value);
            localStorage.setItem('personalPasswordsContent', personalPasswordsContent.value);
        }

        // Add event listeners for input on notepad and personal passwords to save automatically
        notepadContent.addEventListener('input', saveContent);
        personalPasswordsContent.addEventListener('input', saveContent);


        // Initial setup on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Try to load saved background image first
            const savedBackgroundImage = localStorage.getItem('backgroundImage');
            if (savedBackgroundImage) {
                applyBackgroundImage(savedBackgroundImage);
            }
            
            // 2. Load theme and colors (or re-apply if image was present)
            loadInitialThemeAndColors();

            // Store original additional info HTML for filtering
            originalAdditionalInfoContentHTML = additionalInfoContent.innerHTML;

            populateMotivos();
            generateManualLookupContent();
            loadHistory(); // Load and render history on startup
            loadSavedContent(); // Load saved content for textareas

            // Load visibility state for sections
            if (localStorage.getItem('notepadVisible') === 'true') {
                notepadContent.style.display = 'block';
            }
            if (localStorage.getItem('personalPasswordsVisible') === 'true') {
                personalPasswordsContent.style.display = 'block';
            }
            if (localStorage.getItem('historyVisible') === 'true') {
                historyContent.style.display = 'block';
            }
            if (localStorage.getItem('manualLookupVisible') === 'true') {
                manualLookupContent.style.display = 'block';
            }
            if (localStorage.getItem('additionalInfoVisible') === 'true') {
                additionalInfoContent.style.display = 'block';
            }
            if (localStorage.getItem('colorCustomizationVisible') === 'true') {
                colorCustomizationContent.style.display = 'block';
            }
        });
    </script>
</body>
</html>
